[0m11:42:40.815570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bc2d97830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bc443dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bc43b15b0>]}


============================== 11:42:40.819333 | 5ae5c382-97e2-49d1-a825-e16c5b46588b ==============================
[0m11:42:40.819333 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:42:40.820025 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'write_json': 'True', 'use_colors': 'True', 'log_path': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/logs', 'target_path': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt', 'printer_width': '80', 'profiles_dir': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/profiles', 'log_format': 'default', 'no_print': 'None', 'debug': 'False', 'version_check': 'True', 'partial_parse': 'True'}
[0m11:42:41.108617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ae5c382-97e2-49d1-a825-e16c5b46588b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bbca52870>]}
[0m11:42:41.186741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ae5c382-97e2-49d1-a825-e16c5b46588b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bc4ee4920>]}
[0m11:42:41.191864 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:42:41.303728 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:42:41.305214 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:42:41.306144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ae5c382-97e2-49d1-a825-e16c5b46588b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bc25a0230>]}
[0m11:42:42.791524 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:42:42.792155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5ae5c382-97e2-49d1-a825-e16c5b46588b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bbc8402f0>]}
[0m11:42:42.916653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ae5c382-97e2-49d1-a825-e16c5b46588b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bbc732ff0>]}
[0m11:42:43.011962 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m11:42:43.016348 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m11:42:43.036560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ae5c382-97e2-49d1-a825-e16c5b46588b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bbc096480>]}
[0m11:42:43.037315 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m11:42:43.038331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ae5c382-97e2-49d1-a825-e16c5b46588b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bc25a0b30>]}
[0m11:42:43.041505 [info ] [MainThread]: 
[0m11:42:43.042064 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:42:43.042710 [info ] [MainThread]: 
[0m11:42:43.043518 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:42:43.049480 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m11:42:43.092574 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m11:42:43.093058 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m11:42:43.093463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:46.055665 [debug] [ThreadPool]: SQL status: OK in 2.962 seconds
[0m11:42:46.057893 [debug] [ThreadPool]: On list_medallion: Close
[0m11:42:46.059050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m11:42:46.059598 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m11:42:46.066438 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:42:46.066939 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m11:42:46.067390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:46.069374 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:42:46.072166 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:42:46.072650 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m11:42:46.073820 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:42:46.074530 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:42:46.075186 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m11:42:46.076018 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:42:46.077030 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m11:42:46.077459 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:42:46.077857 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m11:42:46.078521 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:42:46.078946 [debug] [ThreadPool]: On create_medallion_main: Close
[0m11:42:46.080235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m11:42:46.086037 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m11:42:46.086835 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m11:42:46.087706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:46.089058 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:42:46.089513 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m11:42:46.090300 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m11:42:46.105116 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m11:42:46.106810 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m11:42:46.108645 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m11:42:46.109126 [debug] [ThreadPool]: On list_medallion_main: Close
[0m11:42:46.109860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ae5c382-97e2-49d1-a825-e16c5b46588b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bbc1313a0>]}
[0m11:42:46.110430 [debug] [MainThread]: Using duckdb connection "master"
[0m11:42:46.110811 [debug] [MainThread]: On master: BEGIN
[0m11:42:46.111222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:42:46.112024 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:42:46.112421 [debug] [MainThread]: On master: COMMIT
[0m11:42:46.112811 [debug] [MainThread]: Using duckdb connection "master"
[0m11:42:46.113213 [debug] [MainThread]: On master: COMMIT
[0m11:42:46.113806 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:42:46.114208 [debug] [MainThread]: On master: Close
[0m11:42:46.117372 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m11:42:46.118570 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m11:42:46.119447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m11:42:46.120395 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m11:42:46.131520 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m11:42:46.132729 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m11:42:46.174453 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m11:42:46.175361 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:42:46.175926 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m11:42:46.176372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:46.177294 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:46.177774 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:42:46.178259 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m11:42:46.179067 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m11:42:46.179552 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:42:46.180152 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m11:42:46.189146 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m11:42:46.189764 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m11:42:46.192526 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m11:42:46.194407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ae5c382-97e2-49d1-a825-e16c5b46588b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bc35e39b0>]}
[0m11:42:46.195369 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.07s]
[0m11:42:46.196315 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m11:42:46.196988 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m11:42:46.198541 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m11:42:46.199063 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m11:42:46.199631 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m11:42:46.201259 [debug] [MainThread]: Using duckdb connection "master"
[0m11:42:46.202027 [debug] [MainThread]: On master: BEGIN
[0m11:42:46.202638 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:42:46.203876 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:42:46.204794 [debug] [MainThread]: On master: COMMIT
[0m11:42:46.205383 [debug] [MainThread]: Using duckdb connection "master"
[0m11:42:46.205786 [debug] [MainThread]: On master: COMMIT
[0m11:42:46.206614 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:42:46.207077 [debug] [MainThread]: On master: Close
[0m11:42:46.207626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:46.208039 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m11:42:46.208435 [info ] [MainThread]: 
[0m11:42:46.208853 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m11:42:46.209642 [debug] [MainThread]: Command end result
[0m11:42:46.238965 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m11:42:46.241704 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m11:42:46.247622 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m11:42:46.248062 [info ] [MainThread]: 
[0m11:42:46.248525 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:42:46.249032 [info ] [MainThread]: 
[0m11:42:46.249875 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m11:42:46.250674 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m11:42:46.251418 [info ] [MainThread]: 
[0m11:42:46.252118 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m11:42:46.252499 [info ] [MainThread]: 
[0m11:42:46.253037 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m11:42:46.254154 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:42:46.256144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.512232, "process_in_blocks": "22136", "process_kernel_time": 0.316222, "process_mem_max_rss": "205236", "process_out_blocks": "45024", "process_user_time": 7.125944}
[0m11:42:46.257224 [debug] [MainThread]: Command `dbt run` failed at 11:42:46.257063 after 5.51 seconds
[0m11:42:46.258039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bc52d1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bc36141a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2bc3615a30>]}
[0m11:42:46.258702 [debug] [MainThread]: Flushing usage events
[0m11:42:47.140978 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:54.783683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7584cc650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7584ce9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7584cd1f0>]}


============================== 11:53:54.789131 | aa3b4873-ae36-4520-b4b8-e991c97e4f5e ==============================
[0m11:53:54.789131 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:53:54.790041 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'target_path': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'log_path': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/logs', 'static_parser': 'True', 'profiles_dir': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/profiles', 'invocation_command': 'dbt run --project-dir /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt', 'version_check': 'True', 'log_format': 'default', 'debug': 'False'}
[0m11:53:55.192350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa3b4873-ae36-4520-b4b8-e991c97e4f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7574ff800>]}
[0m11:53:55.274194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa3b4873-ae36-4520-b4b8-e991c97e4f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a759c2dd00>]}
[0m11:53:55.275877 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:53:55.406906 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:53:55.530003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:55.530461 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:55.578102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa3b4873-ae36-4520-b4b8-e991c97e4f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7574abd10>]}
[0m11:53:55.665017 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m11:53:55.667049 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m11:53:55.682735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa3b4873-ae36-4520-b4b8-e991c97e4f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a750e653a0>]}
[0m11:53:55.683563 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m11:53:55.684302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa3b4873-ae36-4520-b4b8-e991c97e4f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a750e25ee0>]}
[0m11:53:55.687525 [info ] [MainThread]: 
[0m11:53:55.688356 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:53:55.689087 [info ] [MainThread]: 
[0m11:53:55.689956 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:53:55.694796 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m11:53:55.740833 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m11:53:55.741458 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m11:53:55.741932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:55.770412 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m11:53:55.772903 [debug] [ThreadPool]: On list_medallion: Close
[0m11:53:55.773828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m11:53:55.774603 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m11:53:55.781855 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:53:55.782343 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m11:53:55.782799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:55.784671 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:53:55.787109 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:53:55.788069 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m11:53:55.789376 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:53:55.790102 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:53:55.790546 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m11:53:55.791283 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:53:55.792420 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m11:53:55.792957 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:53:55.793408 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m11:53:55.794245 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:53:55.794694 [debug] [ThreadPool]: On create_medallion_main: Close
[0m11:53:55.796108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m11:53:55.803167 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m11:53:55.804076 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m11:53:55.804893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:55.806257 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:53:55.806726 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m11:53:55.807195 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m11:53:55.824028 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m11:53:55.825444 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m11:53:55.826653 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m11:53:55.827048 [debug] [ThreadPool]: On list_medallion_main: Close
[0m11:53:55.827816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa3b4873-ae36-4520-b4b8-e991c97e4f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a75197c320>]}
[0m11:53:55.828416 [debug] [MainThread]: Using duckdb connection "master"
[0m11:53:55.828832 [debug] [MainThread]: On master: BEGIN
[0m11:53:55.829261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:53:55.830070 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:53:55.830500 [debug] [MainThread]: On master: COMMIT
[0m11:53:55.830924 [debug] [MainThread]: Using duckdb connection "master"
[0m11:53:55.831321 [debug] [MainThread]: On master: COMMIT
[0m11:53:55.831998 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:53:55.832697 [debug] [MainThread]: On master: Close
[0m11:53:55.836585 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m11:53:55.837829 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m11:53:55.838685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m11:53:55.839319 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m11:53:55.849302 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m11:53:55.850677 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m11:53:55.886729 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m11:53:55.887655 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:53:55.888215 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m11:53:55.888665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:55.889926 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:53:55.890468 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:53:55.890999 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m11:53:55.900277 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m11:53:55.901413 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:53:55.902610 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m11:53:55.908872 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m11:53:55.909402 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m11:53:55.912139 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m11:53:55.913771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa3b4873-ae36-4520-b4b8-e991c97e4f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a75745c9e0>]}
[0m11:53:55.914498 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.07s]
[0m11:53:55.915294 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m11:53:55.915951 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m11:53:55.917542 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m11:53:55.918449 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m11:53:55.919172 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m11:53:55.920490 [debug] [MainThread]: Using duckdb connection "master"
[0m11:53:55.921172 [debug] [MainThread]: On master: BEGIN
[0m11:53:55.921787 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:53:55.922789 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:53:55.923306 [debug] [MainThread]: On master: COMMIT
[0m11:53:55.923729 [debug] [MainThread]: Using duckdb connection "master"
[0m11:53:55.924223 [debug] [MainThread]: On master: COMMIT
[0m11:53:55.924948 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:53:55.925370 [debug] [MainThread]: On master: Close
[0m11:53:55.925891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:55.926291 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m11:53:55.926712 [info ] [MainThread]: 
[0m11:53:55.927151 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m11:53:55.927957 [debug] [MainThread]: Command end result
[0m11:53:55.960835 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m11:53:55.962846 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m11:53:55.969965 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m11:53:55.970720 [info ] [MainThread]: 
[0m11:53:55.971441 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:53:55.971905 [info ] [MainThread]: 
[0m11:53:55.973021 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m11:53:55.973995 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m11:53:55.974446 [info ] [MainThread]: 
[0m11:53:55.975002 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m11:53:55.975440 [info ] [MainThread]: 
[0m11:53:55.975941 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m11:53:55.977244 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2637677, "process_in_blocks": "81840", "process_kernel_time": 0.245318, "process_mem_max_rss": "152128", "process_out_blocks": "2176", "process_user_time": 2.72643}
[0m11:53:55.977771 [debug] [MainThread]: Command `dbt run` failed at 11:53:55.977666 after 1.26 seconds
[0m11:53:55.978219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a75bf2ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a75851c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a759da49e0>]}
[0m11:53:55.978646 [debug] [MainThread]: Flushing usage events
[0m11:53:56.945817 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:59.380034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730daf8ed640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730daf01fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730daf01fef0>]}


============================== 11:58:59.383421 | 17e571bc-f28c-45c8-8fdd-a4d73ffd2723 ==============================
[0m11:58:59.383421 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:58:59.384096 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --project-dir /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'target_path': 'None', 'log_path': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/logs', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/profiles', 'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True'}
[0m11:58:59.669954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17e571bc-f28c-45c8-8fdd-a4d73ffd2723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730da93db950>]}
[0m11:58:59.751250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17e571bc-f28c-45c8-8fdd-a4d73ffd2723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730daf5590a0>]}
[0m11:58:59.753322 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:58:59.863728 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:58:59.984622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:58:59.985078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:59:00.035218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17e571bc-f28c-45c8-8fdd-a4d73ffd2723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730da92e5cd0>]}
[0m11:59:00.130105 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m11:59:00.131896 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m11:59:00.147651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17e571bc-f28c-45c8-8fdd-a4d73ffd2723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730da8765220>]}
[0m11:59:00.148216 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m11:59:00.148631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17e571bc-f28c-45c8-8fdd-a4d73ffd2723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730da92d6f60>]}
[0m11:59:00.150680 [info ] [MainThread]: 
[0m11:59:00.151199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:59:00.151781 [info ] [MainThread]: 
[0m11:59:00.152550 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:59:00.159223 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m11:59:00.201009 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m11:59:00.201493 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m11:59:00.202119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:00.218293 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m11:59:00.220765 [debug] [ThreadPool]: On list_medallion: Close
[0m11:59:00.221994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m11:59:00.223005 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m11:59:00.230356 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:59:00.230867 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m11:59:00.231297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:00.232548 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:59:00.234054 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:59:00.234485 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m11:59:00.235421 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:59:00.235951 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:59:00.236674 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m11:59:00.237633 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:59:00.239302 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m11:59:00.240111 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:59:00.240590 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m11:59:00.241389 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:59:00.242064 [debug] [ThreadPool]: On create_medallion_main: Close
[0m11:59:00.243791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m11:59:00.249465 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m11:59:00.249964 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m11:59:00.250383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:00.251270 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:59:00.251723 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m11:59:00.252200 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m11:59:00.267312 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m11:59:00.268843 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m11:59:00.271160 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m11:59:00.271834 [debug] [ThreadPool]: On list_medallion_main: Close
[0m11:59:00.272871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17e571bc-f28c-45c8-8fdd-a4d73ffd2723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730da933ce30>]}
[0m11:59:00.273952 [debug] [MainThread]: Using duckdb connection "master"
[0m11:59:00.274697 [debug] [MainThread]: On master: BEGIN
[0m11:59:00.275361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:59:00.276233 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:59:00.276665 [debug] [MainThread]: On master: COMMIT
[0m11:59:00.277104 [debug] [MainThread]: Using duckdb connection "master"
[0m11:59:00.277504 [debug] [MainThread]: On master: COMMIT
[0m11:59:00.278166 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:59:00.278583 [debug] [MainThread]: On master: Close
[0m11:59:00.281325 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m11:59:00.282035 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m11:59:00.282599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m11:59:00.283082 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m11:59:00.294340 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m11:59:00.295092 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m11:59:00.330847 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m11:59:00.331687 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:59:00.332196 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m11:59:00.332691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:00.333873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:59:00.334394 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:59:00.334949 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m11:59:00.335929 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m11:59:00.336566 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:59:00.337263 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m11:59:00.343028 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m11:59:00.343715 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m11:59:00.346714 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m11:59:00.348612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17e571bc-f28c-45c8-8fdd-a4d73ffd2723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730da9371be0>]}
[0m11:59:00.349504 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.06s]
[0m11:59:00.350335 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m11:59:00.351249 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m11:59:00.353795 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m11:59:00.354590 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m11:59:00.355726 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m11:59:00.358045 [debug] [MainThread]: Using duckdb connection "master"
[0m11:59:00.358904 [debug] [MainThread]: On master: BEGIN
[0m11:59:00.359650 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:59:00.360748 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:59:00.361570 [debug] [MainThread]: On master: COMMIT
[0m11:59:00.362068 [debug] [MainThread]: Using duckdb connection "master"
[0m11:59:00.362705 [debug] [MainThread]: On master: COMMIT
[0m11:59:00.363733 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:59:00.364268 [debug] [MainThread]: On master: Close
[0m11:59:00.364834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:00.365265 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m11:59:00.365733 [info ] [MainThread]: 
[0m11:59:00.366232 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m11:59:00.367152 [debug] [MainThread]: Command end result
[0m11:59:00.399336 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m11:59:00.401410 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m11:59:00.410280 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m11:59:00.410784 [info ] [MainThread]: 
[0m11:59:00.411387 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:59:00.411867 [info ] [MainThread]: 
[0m11:59:00.412460 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m11:59:00.413025 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m11:59:00.413472 [info ] [MainThread]: 
[0m11:59:00.414137 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m11:59:00.414594 [info ] [MainThread]: 
[0m11:59:00.415107 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m11:59:00.416207 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1208127, "process_in_blocks": "0", "process_kernel_time": 0.197672, "process_mem_max_rss": "152072", "process_out_blocks": "2176", "process_user_time": 2.707519}
[0m11:59:00.417274 [debug] [MainThread]: Command `dbt run` failed at 11:59:00.417113 after 1.12 seconds
[0m11:59:00.417999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730daf329280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730daee8b140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730daee8bcb0>]}
[0m11:59:00.418843 [debug] [MainThread]: Flushing usage events
[0m11:59:01.774003 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:45.618986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c644d869f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c644895880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c6446e3530>]}


============================== 12:11:45.623200 | 835b502b-c705-4500-8a8c-950c9cd5aa43 ==============================
[0m12:11:45.623200 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:11:45.624027 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_format': 'default', 'log_path': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/logs', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --project-dir /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/profiles', 'empty': 'False', 'use_colors': 'True', 'no_print': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'version_check': 'True', 'printer_width': '80'}
[0m12:11:45.927624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '835b502b-c705-4500-8a8c-950c9cd5aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c643dd5010>]}
[0m12:11:46.011948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '835b502b-c705-4500-8a8c-950c9cd5aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c643c771a0>]}
[0m12:11:46.013658 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:11:46.133450 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:11:46.261199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:11:46.262032 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/fct_customer_transactions.sql
[0m12:11:46.262592 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m12:11:46.778755 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m12:11:46.779331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '835b502b-c705-4500-8a8c-950c9cd5aa43', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c63d624f50>]}
[0m12:11:46.850313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '835b502b-c705-4500-8a8c-950c9cd5aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c63ccb9bb0>]}
[0m12:11:47.045449 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m12:11:47.048007 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m12:11:47.063573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '835b502b-c705-4500-8a8c-950c9cd5aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c63cc1b7d0>]}
[0m12:11:47.064152 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m12:11:47.064614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '835b502b-c705-4500-8a8c-950c9cd5aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c63cce23f0>]}
[0m12:11:47.067392 [info ] [MainThread]: 
[0m12:11:47.068216 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:11:47.068989 [info ] [MainThread]: 
[0m12:11:47.069787 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:11:47.075659 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m12:11:47.118655 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m12:11:47.119331 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m12:11:47.119848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:47.137556 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m12:11:47.139881 [debug] [ThreadPool]: On list_medallion: Close
[0m12:11:47.140694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m12:11:47.141243 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m12:11:47.148019 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:11:47.148519 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m12:11:47.149195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:47.150621 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:11:47.153351 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:11:47.153805 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m12:11:47.154618 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:11:47.155387 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:11:47.156144 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m12:11:47.157305 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:11:47.158537 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:11:47.158943 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:11:47.159313 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:11:47.160031 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:11:47.160429 [debug] [ThreadPool]: On create_medallion_main: Close
[0m12:11:47.161947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m12:11:47.168147 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:11:47.168884 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:11:47.169659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:47.170855 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:11:47.171648 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:11:47.172215 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m12:11:47.186490 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:11:47.188372 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m12:11:47.189665 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m12:11:47.190092 [debug] [ThreadPool]: On list_medallion_main: Close
[0m12:11:47.190844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '835b502b-c705-4500-8a8c-950c9cd5aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c63cd1d400>]}
[0m12:11:47.191405 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:47.191779 [debug] [MainThread]: On master: BEGIN
[0m12:11:47.192144 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:47.193017 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:11:47.193415 [debug] [MainThread]: On master: COMMIT
[0m12:11:47.193787 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:47.194158 [debug] [MainThread]: On master: COMMIT
[0m12:11:47.194766 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:11:47.195166 [debug] [MainThread]: On master: Close
[0m12:11:47.200161 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m12:11:47.200839 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m12:11:47.201761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m12:11:47.202732 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m12:11:47.213485 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m12:11:47.214200 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m12:11:47.253183 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m12:11:47.254006 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:47.254458 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m12:11:47.254861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:47.255780 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:47.256365 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:47.256833 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.

select
    cast(transaction_id as integer) as transaction_id,
    cast(customer_id as integer) as customer_id,
    cast(amount as decimal(10, 2)) as amount,
    cast(status as varchar) as status,
    cast(transaction_ts as timestamp) as transaction_ts,
    cast(transaction_date as date) as transaction_date
from source
  );

[0m12:11:47.260005 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:11:47.266849 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:47.267372 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m12:11:47.268633 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:47.280244 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:11:47.280810 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:47.281535 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:11:47.283806 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:47.292857 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:47.293680 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m12:11:47.295194 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:47.299423 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m12:11:47.302423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835b502b-c705-4500-8a8c-950c9cd5aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c63cd59a90>]}
[0m12:11:47.303881 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.10s]
[0m12:11:47.305160 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m12:11:47.306557 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m12:11:47.307665 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m12:11:47.309152 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m12:11:47.310196 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m12:11:47.313861 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m12:11:47.314653 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m12:11:47.339345 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m12:11:47.340240 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:11:47.340758 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m12:11:47.341244 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:11:47.342314 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:11:47.342843 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:11:47.343339 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select * from "medallion"."main"."stg_transactions"
)

-- TODO: Completar el modelo para que cree la tabla fct_customer_transactions con las metricas en schema.yml.


# queries
select
    customer_id,
    count(*) as transaction_count,
    sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
    sum(amount) as total_amount_all
from base
group by customer_id
    );
  
  
[0m12:11:47.344241 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select * from "medallion"."main"."stg_transactions"
)

-- TODO: Completar el modelo para que cree la tabla fct_customer_transactions con las metricas en schema.yml.


# queries
select
    customer_id,
    count(*) as transaction_count,
    sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
    sum(amount) as total_amount_all
from base
group by customer_id
    );
  
  
[0m12:11:47.344778 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:11:47.345390 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m12:11:47.349850 [debug] [Thread-3 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m12:11:47.350419 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m12:11:47.353795 [debug] [Thread-3 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near "#"
  
  LINE 18: # queries
           ^
[0m12:11:47.354456 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835b502b-c705-4500-8a8c-950c9cd5aa43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c63c2b6c90>]}
[0m12:11:47.355394 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.05s]
[0m12:11:47.356354 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m12:11:47.357534 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near "#"
  
  LINE 18: # queries
           ^.
[0m12:11:47.360923 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:47.361805 [debug] [MainThread]: On master: BEGIN
[0m12:11:47.362579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:47.363922 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:11:47.364645 [debug] [MainThread]: On master: COMMIT
[0m12:11:47.365298 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:47.365923 [debug] [MainThread]: On master: COMMIT
[0m12:11:47.367064 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:11:47.367722 [debug] [MainThread]: On master: Close
[0m12:11:47.368655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:47.369447 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m12:11:47.370219 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m12:11:47.370960 [info ] [MainThread]: 
[0m12:11:47.371649 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m12:11:47.373221 [debug] [MainThread]: Command end result
[0m12:11:47.413033 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m12:11:47.414768 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m12:11:47.422440 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m12:11:47.422885 [info ] [MainThread]: 
[0m12:11:47.423362 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:11:47.423998 [info ] [MainThread]: 
[0m12:11:47.424490 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m12:11:47.424953 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near "#"
  
  LINE 18: # queries
           ^
[0m12:11:47.425321 [info ] [MainThread]: 
[0m12:11:47.425762 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m12:11:47.426362 [info ] [MainThread]: 
[0m12:11:47.426780 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m12:11:47.427668 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:11:47.429033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8790901, "process_in_blocks": "12352", "process_kernel_time": 0.233978, "process_mem_max_rss": "157020", "process_out_blocks": "3232", "process_user_time": 3.621664}
[0m12:11:47.429866 [debug] [MainThread]: Command `dbt run` failed at 12:11:47.429707 after 1.88 seconds
[0m12:11:47.430358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c64635d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c643d3c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c63cd80560>]}
[0m12:11:47.430787 [debug] [MainThread]: Flushing usage events
[0m12:11:48.509488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:12.076117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660c306ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660c3139340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660c306ccb0>]}


============================== 12:16:12.083399 | 5eb0e820-75a3-49c2-a262-a6cca2260812 ==============================
[0m12:16:12.083399 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:16:12.084624 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'quiet': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'empty': 'False', 'use_colors': 'True', 'profiles_dir': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/profiles', 'invocation_command': 'dbt run --project-dir /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt', 'static_parser': 'True', 'log_path': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/logs', 'version_check': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'introspect': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:16:12.410759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5eb0e820-75a3-49c2-a262-a6cca2260812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660c2de0d70>]}
[0m12:16:12.490500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5eb0e820-75a3-49c2-a262-a6cca2260812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660c5794cb0>]}
[0m12:16:12.494821 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:16:12.609381 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:16:12.775266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:16:12.776091 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/fct_customer_transactions.sql
[0m12:16:13.313446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5eb0e820-75a3-49c2-a262-a6cca2260812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660bcfefd40>]}
[0m12:16:13.396297 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m12:16:13.398395 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m12:16:13.481283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5eb0e820-75a3-49c2-a262-a6cca2260812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660a7c521e0>]}
[0m12:16:13.481957 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m12:16:13.482802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5eb0e820-75a3-49c2-a262-a6cca2260812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660c5659b50>]}
[0m12:16:13.485699 [info ] [MainThread]: 
[0m12:16:13.486226 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:16:13.486633 [info ] [MainThread]: 
[0m12:16:13.487268 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:16:13.492365 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m12:16:13.539096 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m12:16:13.539616 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m12:16:13.540038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:13.551461 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m12:16:13.552242 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:16:13.553198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:13.553585 [debug] [MainThread]: Connection 'list_medallion' was properly closed.
[0m12:16:13.553976 [info ] [MainThread]: 
[0m12:16:13.554408 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m12:16:13.555010 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/warehouse/medallion.duckdb": Conflicting lock is held in /snap/duckdb/9/duckdb (PID 32729) by user sebastian. See also https://duckdb.org/docs/stable/connect/concurrency
[0m12:16:13.556004 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5482008, "process_in_blocks": "45776", "process_kernel_time": 0.250527, "process_mem_max_rss": "149108", "process_out_blocks": "2128", "process_user_time": 3.081589}
[0m12:16:13.556536 [debug] [MainThread]: Command `dbt run` failed at 12:16:13.556425 after 1.55 seconds
[0m12:16:13.556992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660c2e78c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660c2f86c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660a7dc77d0>]}
[0m12:16:13.557434 [debug] [MainThread]: Flushing usage events
[0m12:16:14.745999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:43.187411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdf0ffdddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdf106a7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdf100783e0>]}


============================== 12:17:43.192076 | 2d4c8828-e371-4bee-811a-bbcf286defcc ==============================
[0m12:17:43.192076 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:17:43.192692 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'quiet': 'False', 'write_json': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'fail_fast': 'False', 'introspect': 'True', 'profiles_dir': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/profiles', 'invocation_command': 'dbt run --project-dir /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt', 'version_check': 'True', 'empty': 'False', 'log_path': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/logs', 'printer_width': '80'}
[0m12:17:43.443704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d4c8828-e371-4bee-811a-bbcf286defcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdf0fd54fe0>]}
[0m12:17:43.513140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d4c8828-e371-4bee-811a-bbcf286defcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdf105adeb0>]}
[0m12:17:43.517352 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:17:43.620315 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:17:43.740587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:43.741027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:43.781555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d4c8828-e371-4bee-811a-bbcf286defcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdf0983c4d0>]}
[0m12:17:43.860597 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m12:17:43.862565 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m12:17:43.885105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d4c8828-e371-4bee-811a-bbcf286defcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdf0965d6a0>]}
[0m12:17:43.885651 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m12:17:43.886083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d4c8828-e371-4bee-811a-bbcf286defcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdf0989a5d0>]}
[0m12:17:43.888116 [info ] [MainThread]: 
[0m12:17:43.888543 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:43.888934 [info ] [MainThread]: 
[0m12:17:43.889498 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:17:43.894595 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m12:17:43.936629 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m12:17:43.937147 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m12:17:43.937556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:43.960774 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:17:43.962855 [debug] [ThreadPool]: On list_medallion: Close
[0m12:17:43.963627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m12:17:43.964186 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m12:17:43.971107 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:17:43.971590 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m12:17:43.971995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:43.973249 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:17:43.974770 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:17:43.975211 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m12:17:43.975965 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:17:43.976370 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:17:43.976787 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m12:17:43.978040 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:17:43.979165 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:17:43.979629 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:17:43.980040 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:17:43.981015 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:17:43.981501 [debug] [ThreadPool]: On create_medallion_main: Close
[0m12:17:43.982889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m12:17:43.988744 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:17:43.989230 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:17:43.989615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:43.990435 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:17:43.990862 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:17:43.991294 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m12:17:44.004785 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:17:44.006319 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m12:17:44.007870 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m12:17:44.008299 [debug] [ThreadPool]: On list_medallion_main: Close
[0m12:17:44.009250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d4c8828-e371-4bee-811a-bbcf286defcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdf0989ba10>]}
[0m12:17:44.009808 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:44.010235 [debug] [MainThread]: On master: BEGIN
[0m12:17:44.010600 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:44.011512 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:17:44.011924 [debug] [MainThread]: On master: COMMIT
[0m12:17:44.012308 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:44.012932 [debug] [MainThread]: On master: COMMIT
[0m12:17:44.013540 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:17:44.013939 [debug] [MainThread]: On master: Close
[0m12:17:44.017005 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m12:17:44.017656 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m12:17:44.018199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m12:17:44.018692 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m12:17:44.028388 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m12:17:44.029062 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m12:17:44.059189 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m12:17:44.059959 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:17:44.060414 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m12:17:44.060866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:44.061768 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:44.062240 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:17:44.062693 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.

select
    cast(transaction_id as integer) as transaction_id,
    cast(customer_id as integer) as customer_id,
    cast(amount as decimal(10, 2)) as amount,
    cast(status as varchar) as status,
    cast(transaction_ts as timestamp) as transaction_ts,
    cast(transaction_date as date) as transaction_date
from source
  );

[0m12:17:44.064388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:44.075675 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:17:44.076596 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m12:17:44.078558 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:44.084451 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:17:44.085493 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m12:17:44.087589 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:44.107490 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:17:44.108049 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:17:44.108495 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:17:44.111468 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:17:44.118687 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:17:44.119347 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m12:17:44.121093 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:44.123928 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m12:17:44.125878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d4c8828-e371-4bee-811a-bbcf286defcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdf084a61e0>]}
[0m12:17:44.126627 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.11s]
[0m12:17:44.127342 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m12:17:44.128394 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m12:17:44.129419 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m12:17:44.130235 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m12:17:44.130707 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m12:17:44.135194 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m12:17:44.135900 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m12:17:44.157887 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m12:17:44.158785 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:17:44.159417 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m12:17:44.160052 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:17:44.161595 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:17:44.162398 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:17:44.162984 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select * from "medallion"."main"."stg_transactions"
)

-- TODO: Completar el modelo para que cree la tabla fct_customer_transactions con las metricas en schema.yml.

-- queries
select
    customer_id,
    count(*) as transaction_count,
    sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
    sum(amount) as total_amount_all
from base
group by customer_id
    );
  
  
[0m12:17:44.180024 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m12:17:44.184667 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:17:44.185268 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions__dbt_tmp" rename to "fct_customer_transactions"
[0m12:17:44.186214 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:17:44.191072 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m12:17:44.191559 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:17:44.191979 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m12:17:44.193397 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:17:44.196129 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:17:44.196747 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

      drop table if exists "medallion"."main"."fct_customer_transactions__dbt_backup" cascade
    
[0m12:17:44.197851 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m12:17:44.200026 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m12:17:44.200896 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d4c8828-e371-4bee-811a-bbcf286defcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdf083c7230>]}
[0m12:17:44.201707 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.fct_customer_transactions ............... [[32mOK[0m in 0.07s]
[0m12:17:44.202391 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m12:17:44.203805 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:44.204537 [debug] [MainThread]: On master: BEGIN
[0m12:17:44.205219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:44.206340 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:17:44.206750 [debug] [MainThread]: On master: COMMIT
[0m12:17:44.207150 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:44.207510 [debug] [MainThread]: On master: COMMIT
[0m12:17:44.208139 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:17:44.208545 [debug] [MainThread]: On master: Close
[0m12:17:44.209046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:44.209401 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m12:17:44.209738 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m12:17:44.210135 [info ] [MainThread]: 
[0m12:17:44.210562 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m12:17:44.212088 [debug] [MainThread]: Command end result
[0m12:17:44.240361 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m12:17:44.242105 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m12:17:44.248739 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m12:17:44.249557 [info ] [MainThread]: 
[0m12:17:44.250350 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:44.250824 [info ] [MainThread]: 
[0m12:17:44.251321 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:17:44.252310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1254659, "process_in_blocks": "48944", "process_kernel_time": 0.232445, "process_mem_max_rss": "154832", "process_out_blocks": "2240", "process_user_time": 2.483027}
[0m12:17:44.252902 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:44.252771 after 1.13 seconds
[0m12:17:44.253478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdf0fc82a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdf1046c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdf09a49e80>]}
[0m12:17:44.253986 [debug] [MainThread]: Flushing usage events
[0m12:17:45.475389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:49.038711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc2681b7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc267eb8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc267bb3f80>]}


============================== 12:17:49.041982 | 8052a754-e177-422d-a173-297aacee98f0 ==============================
[0m12:17:49.041982 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:17:49.042636 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error': 'None', 'log_format': 'default', 'log_path': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/logs', 'static_parser': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'no_print': 'None', 'profiles_dir': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/profiles', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt test --project-dir /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt', 'cache_selected_only': 'False', 'empty': 'None'}
[0m12:17:49.400061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8052a754-e177-422d-a173-297aacee98f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc266f3c0b0>]}
[0m12:17:49.481369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8052a754-e177-422d-a173-297aacee98f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc266d61310>]}
[0m12:17:49.483452 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:17:49.594102 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:17:49.709832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:49.710284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:49.757691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8052a754-e177-422d-a173-297aacee98f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc2613d4d40>]}
[0m12:17:49.853045 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m12:17:49.854831 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m12:17:49.885521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8052a754-e177-422d-a173-297aacee98f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc26073f080>]}
[0m12:17:49.886142 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m12:17:49.886596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8052a754-e177-422d-a173-297aacee98f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc261134bf0>]}
[0m12:17:49.889174 [info ] [MainThread]: 
[0m12:17:49.889648 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:49.890050 [info ] [MainThread]: 
[0m12:17:49.890621 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:17:49.896073 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m12:17:49.936570 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:17:49.937064 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:17:49.937468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:49.954436 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m12:17:49.954969 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:17:49.955399 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m12:17:49.970078 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:17:49.971695 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m12:17:49.973035 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m12:17:49.973447 [debug] [ThreadPool]: On list_medallion_main: Close
[0m12:17:49.974565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8052a754-e177-422d-a173-297aacee98f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc2613414f0>]}
[0m12:17:49.975249 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:49.975620 [debug] [MainThread]: On master: BEGIN
[0m12:17:49.975989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:49.976817 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:17:49.977289 [debug] [MainThread]: On master: COMMIT
[0m12:17:49.977977 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:49.978513 [debug] [MainThread]: On master: COMMIT
[0m12:17:49.979236 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:17:49.979809 [debug] [MainThread]: On master: Close
[0m12:17:49.983297 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m12:17:49.983804 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:17:49.984408 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:17:49.985144 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:17:49.985779 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_stg_transactions_status__completed__pending__failed  [RUN]
[0m12:17:49.986564 [info ] [Thread-2 (]: 2 of 16 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m12:17:49.987261 [info ] [Thread-3 (]: 3 of 16 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m12:17:49.988019 [info ] [Thread-4 (]: 4 of 16 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m12:17:49.988687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26)
[0m12:17:49.989511 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m12:17:49.990207 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m12:17:49.991040 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m12:17:49.991620 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m12:17:49.992345 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:17:49.992901 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:17:49.993507 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:17:50.022880 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:17:50.025247 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m12:17:50.030215 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:17:50.035097 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:17:50.036398 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:17:50.037338 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:17:50.038100 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m12:17:50.060989 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:17:50.061984 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:17:50.065708 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:17:50.068694 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m12:17:50.070924 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:17:50.072218 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m12:17:50.073078 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:17:50.073898 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:17:50.074680 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: BEGIN
[0m12:17:50.075295 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:17:50.075778 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m12:17:50.076243 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m12:17:50.076819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:50.077753 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m12:17:50.078665 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:17:50.079606 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:17:50.081046 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:17:50.082370 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:17:50.083680 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m12:17:50.084768 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m12:17:50.085371 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m12:17:50.086196 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:17:50.086975 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m12:17:50.087439 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m12:17:50.087971 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:17:50.088445 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m12:17:50.088991 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:17:50.090953 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m12:17:50.089672 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m12:17:50.095160 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:17:50.096013 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m12:17:50.096977 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:17:50.097666 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m12:17:50.103039 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m12:17:50.104858 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m12:17:50.106634 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m12:17:50.107695 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m12:17:50.108729 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m12:17:50.110571 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m12:17:50.113458 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: ROLLBACK
[0m12:17:50.114425 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m12:17:50.115319 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m12:17:50.115948 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m12:17:50.117145 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26'
[0m12:17:50.118021 [info ] [Thread-4 (]: 4 of 16 PASS non_negative_fct_customer_transactions_transaction_count .......... [[32mPASS[0m in 0.13s]
[0m12:17:50.118689 [info ] [Thread-3 (]: 3 of 16 PASS non_negative_fct_customer_transactions_total_amount_completed ..... [[32mPASS[0m in 0.13s]
[0m12:17:50.119408 [info ] [Thread-2 (]: 2 of 16 PASS non_negative_fct_customer_transactions_total_amount_all ........... [[32mPASS[0m in 0.13s]
[0m12:17:50.119989 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: Close
[0m12:17:50.120682 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:17:50.121375 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:17:50.122030 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:17:50.122665 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m12:17:50.123382 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:17:50.124200 [info ] [Thread-1 (]: 1 of 16 PASS accepted_values_stg_transactions_status__completed__pending__failed  [[32mPASS[0m in 0.14s]
[0m12:17:50.124889 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:17:50.125375 [info ] [Thread-4 (]: 5 of 16 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m12:17:50.125958 [info ] [Thread-3 (]: 6 of 16 START test not_null_fct_customer_transactions_customer_id .............. [RUN]
[0m12:17:50.126604 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m12:17:50.127191 [info ] [Thread-2 (]: 7 of 16 START test not_null_fct_customer_transactions_total_amount_all ......... [RUN]
[0m12:17:50.128488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m12:17:50.129147 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m12:17:50.129900 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:17:50.130797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m12:17:50.131724 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m12:17:50.132500 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:17:50.133924 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:17:50.133385 [info ] [Thread-1 (]: 8 of 16 START test not_null_fct_customer_transactions_total_amount_completed ... [RUN]
[0m12:17:50.138705 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m12:17:50.146711 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:17:50.153504 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:17:50.154159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m12:17:50.155176 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m12:17:50.155982 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:17:50.156651 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:17:50.158771 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m12:17:50.159286 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:17:50.161671 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:17:50.166981 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:17:50.169451 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:17:50.170240 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m12:17:50.170893 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:17:50.171901 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m12:17:50.172583 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:17:50.173358 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m12:17:50.174042 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:17:50.174554 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:17:50.175235 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m12:17:50.175790 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:17:50.178406 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:17:50.179375 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:17:50.180738 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m12:17:50.182218 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:17:50.183113 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m12:17:50.183971 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m12:17:50.184490 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m12:17:50.184980 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m12:17:50.185421 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:17:50.186008 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m12:17:50.186520 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:17:50.186986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:50.187434 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:17:50.188240 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m12:17:50.189299 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:17:50.190139 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:17:50.190632 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:17:50.191304 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:17:50.193734 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m12:17:50.194710 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:17:50.197354 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m12:17:50.198429 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m12:17:50.200848 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m12:17:50.202221 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m12:17:50.203857 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m12:17:50.204691 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m12:17:50.205320 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m12:17:50.205967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:50.207779 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m12:17:50.208723 [info ] [Thread-4 (]: 5 of 16 PASS non_negative_stg_transactions_amount .............................. [[32mPASS[0m in 0.08s]
[0m12:17:50.209379 [info ] [Thread-3 (]: 6 of 16 PASS not_null_fct_customer_transactions_customer_id .................... [[32mPASS[0m in 0.08s]
[0m12:17:50.210081 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m12:17:50.212744 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m12:17:50.214288 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m12:17:50.215574 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:17:50.216568 [info ] [Thread-2 (]: 7 of 16 PASS not_null_fct_customer_transactions_total_amount_all ............... [[32mPASS[0m in 0.09s]
[0m12:17:50.218235 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m12:17:50.218715 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:17:50.219264 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m12:17:50.220096 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:17:50.220555 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m12:17:50.221045 [info ] [Thread-4 (]: 9 of 16 START test not_null_fct_customer_transactions_transaction_count ........ [RUN]
[0m12:17:50.221601 [info ] [Thread-3 (]: 10 of 16 START test not_null_stg_transactions_amount ........................... [RUN]
[0m12:17:50.222318 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m12:17:50.223185 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m12:17:50.223804 [info ] [Thread-1 (]: 8 of 16 PASS not_null_fct_customer_transactions_total_amount_completed ......... [[32mPASS[0m in 0.07s]
[0m12:17:50.224446 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m12:17:50.225168 [info ] [Thread-2 (]: 11 of 16 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m12:17:50.225731 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:17:50.226385 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:17:50.226819 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m12:17:50.227433 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m12:17:50.233941 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:17:50.234770 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m12:17:50.238565 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m12:17:50.239217 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m12:17:50.239954 [info ] [Thread-1 (]: 12 of 16 START test not_null_stg_transactions_status ........................... [RUN]
[0m12:17:50.246192 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m12:17:50.247137 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:17:50.248182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m12:17:50.249206 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m12:17:50.252202 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:17:50.252761 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m12:17:50.253233 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m12:17:50.255274 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m12:17:50.256024 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:17:50.262329 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m12:17:50.318071 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m12:17:50.318686 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m12:17:50.319327 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m12:17:50.320045 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:17:50.320942 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m12:17:50.321677 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m12:17:50.322720 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m12:17:50.323417 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m12:17:50.324123 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:17:50.324580 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m12:17:50.327616 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m12:17:50.328565 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:17:50.329540 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:17:50.330662 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m12:17:50.332155 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m12:17:50.333019 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:17:50.333729 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m12:17:50.334730 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m12:17:50.335454 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m12:17:50.335998 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m12:17:50.336987 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m12:17:50.337634 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:17:50.338106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:50.338740 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:17:50.341007 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m12:17:50.341628 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:17:50.343577 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m12:17:50.344402 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:17:50.345645 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m12:17:50.346505 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:17:50.348581 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m12:17:50.349224 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m12:17:50.350257 [info ] [Thread-4 (]: 9 of 16 PASS not_null_fct_customer_transactions_transaction_count .............. [[32mPASS[0m in 0.13s]
[0m12:17:50.351570 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m12:17:50.353511 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m12:17:50.354025 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m12:17:50.354731 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:17:50.355258 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m12:17:50.356435 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m12:17:50.357232 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m12:17:50.358206 [info ] [Thread-3 (]: 10 of 16 PASS not_null_stg_transactions_amount ................................. [[32mPASS[0m in 0.13s]
[0m12:17:50.359140 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m12:17:50.359942 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:17:50.360864 [info ] [Thread-4 (]: 13 of 16 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m12:17:50.362194 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m12:17:50.363429 [info ] [Thread-2 (]: 11 of 16 PASS not_null_stg_transactions_customer_id ............................ [[32mPASS[0m in 0.14s]
[0m12:17:50.366383 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m12:17:50.366990 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m12:17:50.367940 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m12:17:50.368954 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m12:17:50.370544 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m12:17:50.371300 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m12:17:50.371887 [info ] [Thread-3 (]: 14 of 16 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m12:17:50.372701 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m12:17:50.373286 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m12:17:50.380381 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m12:17:50.381170 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m12:17:50.382167 [info ] [Thread-2 (]: 15 of 16 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m12:17:50.383446 [info ] [Thread-1 (]: 12 of 16 PASS not_null_stg_transactions_status ................................. [[32mPASS[0m in 0.14s]
[0m12:17:50.384409 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m12:17:50.385232 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m12:17:50.386156 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m12:17:50.387131 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m12:17:50.391829 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m12:17:50.394620 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m12:17:50.395457 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m12:17:50.396389 [debug] [Thread-1 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m12:17:50.397949 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m12:17:50.398779 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m12:17:50.403111 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m12:17:50.403703 [info ] [Thread-1 (]: 16 of 16 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m12:17:50.406073 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m12:17:50.406639 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m12:17:50.407331 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m12:17:50.407860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m12:17:50.408550 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:17:50.412346 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m12:17:50.413117 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m12:17:50.414154 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m12:17:50.415770 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m12:17:50.416696 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m12:17:50.417492 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m12:17:50.423667 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m12:17:50.424239 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:17:50.424727 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m12:17:50.425244 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m12:17:50.426199 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:17:50.426700 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m12:17:50.427380 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m12:17:50.428436 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m12:17:50.432392 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m12:17:50.433116 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m12:17:50.433933 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m12:17:50.434975 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m12:17:50.435590 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m12:17:50.436116 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:17:50.436635 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m12:17:50.437399 [debug] [Thread-1 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m12:17:50.438324 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m12:17:50.440399 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m12:17:50.440982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:50.441440 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:17:50.442882 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m12:17:50.443885 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:17:50.444884 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:17:50.447551 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m12:17:50.448225 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m12:17:50.448973 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m12:17:50.450498 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m12:17:50.451714 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m12:17:50.452466 [info ] [Thread-4 (]: 13 of 16 PASS not_null_stg_transactions_transaction_date ....................... [[32mPASS[0m in 0.09s]
[0m12:17:50.453282 [debug] [Thread-1 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:17:50.454495 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m12:17:50.455017 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m12:17:50.455865 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m12:17:50.456604 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m12:17:50.457542 [info ] [Thread-3 (]: 14 of 16 PASS not_null_stg_transactions_transaction_id ......................... [[32mPASS[0m in 0.08s]
[0m12:17:50.458468 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:17:50.459375 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m12:17:50.460017 [info ] [Thread-2 (]: 15 of 16 PASS not_null_stg_transactions_transaction_ts ......................... [[32mPASS[0m in 0.07s]
[0m12:17:50.462664 [debug] [Thread-1 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m12:17:50.464291 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m12:17:50.466557 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m12:17:50.467668 [debug] [Thread-1 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m12:17:50.468445 [info ] [Thread-1 (]: 16 of 16 PASS unique_stg_transactions_transaction_id ........................... [[32mPASS[0m in 0.06s]
[0m12:17:50.469179 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m12:17:50.470620 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:50.471053 [debug] [MainThread]: On master: BEGIN
[0m12:17:50.471420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:50.472179 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:17:50.472577 [debug] [MainThread]: On master: COMMIT
[0m12:17:50.472969 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:50.473332 [debug] [MainThread]: On master: COMMIT
[0m12:17:50.473971 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:17:50.474364 [debug] [MainThread]: On master: Close
[0m12:17:50.474831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:50.475203 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m12:17:50.475539 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' was properly closed.
[0m12:17:50.475873 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' was properly closed.
[0m12:17:50.476260 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m12:17:50.476653 [info ] [MainThread]: 
[0m12:17:50.477069 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m12:17:50.482433 [debug] [MainThread]: Command end result
[0m12:17:50.515543 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m12:17:50.517513 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m12:17:50.525439 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m12:17:50.525965 [info ] [MainThread]: 
[0m12:17:50.526483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:50.527007 [info ] [MainThread]: 
[0m12:17:50.528000 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m12:17:50.529332 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5575638, "process_in_blocks": "18360", "process_kernel_time": 0.25717, "process_mem_max_rss": "155688", "process_out_blocks": "2536", "process_user_time": 3.062034}
[0m12:17:50.530441 [debug] [MainThread]: Command `dbt test` succeeded at 12:17:50.530228 after 1.56 seconds
[0m12:17:50.531334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc269b79970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc267bb3f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc266f6eb70>]}
[0m12:17:50.532174 [debug] [MainThread]: Flushing usage events
[0m12:17:51.409942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:36.903246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ec9d27740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ecacf5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ec823f860>]}


============================== 12:26:36.906573 | f267b81b-1d60-4147-88dd-0bfdbd5cc16d ==============================
[0m12:26:36.906573 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:26:36.907624 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None', 'version_check': 'True', 'empty': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'printer_width': '80', 'log_format': 'default', 'log_path': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/logs', 'profiles_dir': '/home/sebastian/.dbt', 'debug': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'no_print': 'None', 'log_cache_events': 'False'}
[0m12:26:36.911041 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'medallion_duckdb'
[0m12:26:36.912121 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.08132781, "process_in_blocks": "552", "process_kernel_time": 0.166717, "process_mem_max_rss": "100776", "process_out_blocks": "8", "process_user_time": 1.603287}
[0m12:26:36.912734 [debug] [MainThread]: Command `dbt run` failed at 12:26:36.912565 after 0.08 seconds
[0m12:26:36.913552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ec8849730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ec829aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ec8299250>]}
[0m12:26:36.914498 [debug] [MainThread]: Flushing usage events
[0m12:26:38.116724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:28:01.304979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788ead6f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788df553d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7890449c40>]}


============================== 12:28:01.308276 | f0d55415-d3c8-4977-bf5a-0943fe696b92 ==============================
[0m12:28:01.308276 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:28:01.308988 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/logs', 'printer_width': '80', 'version_check': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_colors': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'no_print': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'target_path': 'None', 'quiet': 'False', 'profiles_dir': '/home/sebastian/.dbt'}
[0m12:28:01.311792 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'medallion_duckdb'
[0m12:28:01.312791 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.06774062, "process_in_blocks": "0", "process_kernel_time": 0.120586, "process_mem_max_rss": "100868", "process_out_blocks": "8", "process_user_time": 1.515803}
[0m12:28:01.313407 [debug] [MainThread]: Command `dbt run` failed at 12:28:01.313275 after 0.07 seconds
[0m12:28:01.314077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788d76f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788e7dba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788dead760>]}
[0m12:28:01.314989 [debug] [MainThread]: Flushing usage events
[0m12:28:02.375349 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:28:04.796321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702a7792ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702a76e7e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702a77b89f40>]}


============================== 12:28:04.801376 | c620185d-6fda-4ebc-9738-c0d5b5635ce6 ==============================
[0m12:28:04.801376 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:28:04.802567 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_path': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/logs', 'printer_width': '80', 'profiles_dir': '../profiles', 'warn_error': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt test', 'no_print': 'None', 'partial_parse': 'True', 'introspect': 'True', 'use_colors': 'True', 'target_path': 'None'}
[0m12:28:05.155366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c620185d-6fda-4ebc-9738-c0d5b5635ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702a76cfa870>]}
[0m12:28:05.229759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c620185d-6fda-4ebc-9738-c0d5b5635ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702a7116c0b0>]}
[0m12:28:05.231449 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:28:05.333757 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:28:05.427547 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:28:05.428136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c620185d-6fda-4ebc-9738-c0d5b5635ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702a775dd8b0>]}
[0m12:28:06.739414 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m12:28:06.740077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c620185d-6fda-4ebc-9738-c0d5b5635ce6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702a70eb7140>]}
[0m12:28:06.865551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c620185d-6fda-4ebc-9738-c0d5b5635ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702a705d69c0>]}
[0m12:28:06.946423 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m12:28:06.948937 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m12:28:06.971928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c620185d-6fda-4ebc-9738-c0d5b5635ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702a70d7fc80>]}
[0m12:28:06.972521 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m12:28:06.973033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c620185d-6fda-4ebc-9738-c0d5b5635ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702a6ba3a810>]}
[0m12:28:06.975668 [info ] [MainThread]: 
[0m12:28:06.976259 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:06.976722 [info ] [MainThread]: 
[0m12:28:06.977639 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:28:06.984046 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m12:28:07.026328 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:28:07.026810 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:28:07.027227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:07.034542 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m12:28:07.035043 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:28:07.035969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:07.036586 [debug] [MainThread]: Connection 'list_medallion_main' was properly closed.
[0m12:28:07.037208 [info ] [MainThread]: 
[0m12:28:07.037736 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m12:28:07.038543 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/home/w1ndman/laboral/examen_ing_de_sw_n_data/warehouse/medallion.duckdb": No such file or directory
[0m12:28:07.039546 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:28:07.040937 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.3422985, "process_in_blocks": "264", "process_kernel_time": 0.214755, "process_mem_max_rss": "150980", "process_out_blocks": "2104", "process_user_time": 4.199228}
[0m12:28:07.041787 [debug] [MainThread]: Command `dbt test` failed at 12:28:07.041655 after 2.34 seconds
[0m12:28:07.042324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702a775ddee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702a76c85c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702a705d7fb0>]}
[0m12:28:07.042996 [debug] [MainThread]: Flushing usage events
[0m12:28:07.911881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:30:54.850421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7750414d4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775040f8fa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775040d775c0>]}


============================== 12:30:54.859040 | 3ac225ef-34b6-4ea2-bb88-a96686d1a836 ==============================
[0m12:30:54.859040 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:30:54.859726 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/profiles', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'no_print': 'None', 'empty': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'debug': 'False'}
[0m12:30:55.107240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ac225ef-34b6-4ea2-bb88-a96686d1a836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77503a93f830>]}
[0m12:30:55.177427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ac225ef-34b6-4ea2-bb88-a96686d1a836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7750409ab230>]}
[0m12:30:55.179078 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:30:55.287032 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:30:55.383059 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:30:55.383632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3ac225ef-34b6-4ea2-bb88-a96686d1a836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77503a66aba0>]}
[0m12:30:56.611937 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m12:30:56.612493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3ac225ef-34b6-4ea2-bb88-a96686d1a836', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775040541940>]}
[0m12:30:56.718795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ac225ef-34b6-4ea2-bb88-a96686d1a836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77503945baa0>]}
[0m12:30:56.797321 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m12:30:56.799307 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m12:30:56.813113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ac225ef-34b6-4ea2-bb88-a96686d1a836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77503949f350>]}
[0m12:30:56.813672 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m12:30:56.814171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ac225ef-34b6-4ea2-bb88-a96686d1a836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775039439e50>]}
[0m12:30:56.817116 [info ] [MainThread]: 
[0m12:30:56.817927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:30:56.818426 [info ] [MainThread]: 
[0m12:30:56.819155 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:30:56.824218 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m12:30:56.865122 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m12:30:56.865593 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m12:30:56.865968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:56.872400 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m12:30:56.872871 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:30:56.873759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:56.874139 [debug] [MainThread]: Connection 'list_medallion' was properly closed.
[0m12:30:56.874517 [info ] [MainThread]: 
[0m12:30:56.875118 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m12:30:56.876006 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/warehouse/medallion.duckdb": Conflicting lock is held in /snap/duckdb/9/duckdb (PID 33229) by user sebastian. See also https://duckdb.org/docs/stable/connect/concurrency
[0m12:30:56.876987 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:30:56.878276 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0869684, "process_in_blocks": "1296", "process_kernel_time": 0.206634, "process_mem_max_rss": "149960", "process_out_blocks": "2120", "process_user_time": 3.435918}
[0m12:30:56.879453 [debug] [MainThread]: Command `dbt run` failed at 12:30:56.879251 after 2.09 seconds
[0m12:30:56.880216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77504317db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77503952d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7750393179e0>]}
[0m12:30:56.881017 [debug] [MainThread]: Flushing usage events
[0m12:30:57.694691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:30:59.690265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c7846e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c7810f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c78371d00>]}


============================== 12:30:59.693480 | 6f1bc72f-8452-4994-8edc-2b338bbfeaed ==============================
[0m12:30:59.693480 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:30:59.694247 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': '../profiles', 'log_path': '/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'target_path': 'None', 'warn_error': 'None', 'printer_width': '80', 'invocation_command': 'dbt test', 'no_print': 'None', 'introspect': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_format': 'default', 'quiet': 'False'}
[0m12:30:59.938991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f1bc72f-8452-4994-8edc-2b338bbfeaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c7786e120>]}
[0m12:31:00.009123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f1bc72f-8452-4994-8edc-2b338bbfeaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c719dfcb0>]}
[0m12:31:00.010813 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:31:00.107734 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:31:00.211192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:31:00.211622 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:31:00.253412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f1bc72f-8452-4994-8edc-2b338bbfeaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c783e5490>]}
[0m12:31:00.327928 [debug] [MainThread]: Wrote artifact WritableManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m12:31:00.330352 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m12:31:00.356976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f1bc72f-8452-4994-8edc-2b338bbfeaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c71357c20>]}
[0m12:31:00.357534 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m12:31:00.358048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f1bc72f-8452-4994-8edc-2b338bbfeaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c77456060>]}
[0m12:31:00.360590 [info ] [MainThread]: 
[0m12:31:00.361088 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:31:00.361483 [info ] [MainThread]: 
[0m12:31:00.362151 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:31:00.367166 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m12:31:00.407847 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:31:00.408425 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:31:00.408830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:00.415189 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m12:31:00.415687 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:31:00.416681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:00.417054 [debug] [MainThread]: Connection 'list_medallion_main' was properly closed.
[0m12:31:00.417396 [info ] [MainThread]: 
[0m12:31:00.417808 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m12:31:00.418372 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/sebastian/Escritorio/MIA/MIA_soft_ing/examen_ing_de_sw_n_data_final/warehouse/medallion.duckdb": Conflicting lock is held in /snap/duckdb/9/duckdb (PID 33229) by user sebastian. See also https://duckdb.org/docs/stable/connect/concurrency
[0m12:31:00.419291 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.78826386, "process_in_blocks": "0", "process_kernel_time": 0.213313, "process_mem_max_rss": "145976", "process_out_blocks": "1096", "process_user_time": 2.192943}
[0m12:31:00.419818 [debug] [MainThread]: Command `dbt test` failed at 12:31:00.419701 after 0.79 seconds
[0m12:31:00.420274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c77d1ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c71916810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c7197b620>]}
[0m12:31:00.421143 [debug] [MainThread]: Flushing usage events
[0m12:31:01.713950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:44.449723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60b2ac190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60b161cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60a1b9330>]}


============================== 13:36:44.454463 | cb574232-11d2-4507-856f-fb93576f4e1e ==============================
[0m13:36:44.454463 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:36:44.455191 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'profiles_dir': '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/profiles', 'invocation_command': 'dbt run --project-dir /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt', 'log_format': 'default', 'warn_error': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'write_json': 'True', 'target_path': 'None', 'static_parser': 'True', 'log_path': '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/logs', 'debug': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'introspect': 'True', 'fail_fast': 'False'}
[0m13:36:45.028167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb574232-11d2-4507-856f-fb93576f4e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60cce5f90>]}
[0m13:36:45.113554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb574232-11d2-4507-856f-fb93576f4e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60aa8d180>]}
[0m13:36:45.118677 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:36:45.241658 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:36:45.435357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:36:45.436543 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/fct_customer_transactions.sql
[0m13:36:45.437176 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m13:36:46.165647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb574232-11d2-4507-856f-fb93576f4e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c3f55870>]}
[0m13:36:46.277767 [debug] [MainThread]: Wrote artifact WritableManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/manifest.json
[0m13:36:46.289506 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/semantic_manifest.json
[0m13:36:46.313639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb574232-11d2-4507-856f-fb93576f4e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6013849a0>]}
[0m13:36:46.314368 [info ] [MainThread]: Found 2 models, 29 data tests, 454 macros
[0m13:36:46.314909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb574232-11d2-4507-856f-fb93576f4e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6013960b0>]}
[0m13:36:46.317211 [info ] [MainThread]: 
[0m13:36:46.317783 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:36:46.318318 [info ] [MainThread]: 
[0m13:36:46.319021 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:36:46.326183 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m13:36:46.369998 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m13:36:46.370796 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m13:36:46.371483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:46.456845 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m13:36:46.458870 [debug] [ThreadPool]: On list_medallion: Close
[0m13:36:46.459794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m13:36:46.460450 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m13:36:46.468629 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:36:46.469159 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m13:36:46.469668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:46.471094 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:36:46.472941 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:36:46.473520 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m13:36:46.474320 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:36:46.474837 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:36:46.475341 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m13:36:46.476828 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:36:46.477920 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:36:46.478448 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m13:36:46.478945 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m13:36:46.479641 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:36:46.480152 [debug] [ThreadPool]: On create_medallion_main: Close
[0m13:36:46.481684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m13:36:46.489790 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:36:46.490399 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m13:36:46.490887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:46.491773 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:36:46.492251 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:36:46.492744 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m13:36:46.510989 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m13:36:46.512588 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m13:36:46.514058 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m13:36:46.514569 [debug] [ThreadPool]: On list_medallion_main: Close
[0m13:36:46.515450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb574232-11d2-4507-856f-fb93576f4e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c3f04df0>]}
[0m13:36:46.516101 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:46.516602 [debug] [MainThread]: On master: BEGIN
[0m13:36:46.517060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:46.517881 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:36:46.518366 [debug] [MainThread]: On master: COMMIT
[0m13:36:46.518850 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:46.519316 [debug] [MainThread]: On master: COMMIT
[0m13:36:46.519976 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:46.520503 [debug] [MainThread]: On master: Close
[0m13:36:46.523687 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m13:36:46.524514 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m13:36:46.525190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m13:36:46.525739 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m13:36:46.539392 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m13:36:46.540277 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m13:36:46.585612 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m13:36:46.586597 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:36:46.587268 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m13:36:46.587971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:46.589321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:36:46.590021 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:36:46.590626 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/data/clean/transactions_20251201_clean.parquet'
    )
)

select
    cast(transaction_id as integer) as transaction_id,
    cast(customer_id as integer) as customer_id,
    cast(amount as decimal(10, 2)) as amount,
    cast(status as varchar) as status,
    cast(transaction_ts as timestamp) as transaction_ts,
    cast(transaction_date as date) as transaction_date
from source
  );

[0m13:36:46.597554 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:36:46.605783 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:36:46.606532 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m13:36:46.607632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:36:46.622030 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m13:36:46.622884 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:36:46.623575 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m13:36:46.639368 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m13:36:46.647207 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m13:36:46.648143 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m13:36:46.649281 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:36:46.652582 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m13:36:46.655122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb574232-11d2-4507-856f-fb93576f4e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c3f3c130>]}
[0m13:36:46.656253 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.13s]
[0m13:36:46.657107 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m13:36:46.658083 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m13:36:46.659064 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m13:36:46.659876 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m13:36:46.660460 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m13:36:46.665764 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m13:36:46.666640 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m13:36:46.691427 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m13:36:46.692441 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:36:46.693032 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m13:36:46.693579 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:36:46.694580 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:36:46.695134 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:36:46.695723 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select * from "medallion"."main"."stg_transactions"
)

-- TODO: Completar el modelo para que cree la tabla fct_customer_transactions con las metricas en schema.yml.

-- queries
select
    customer_id,
    count(*) as transaction_count,
    sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
    sum(amount) as total_amount_all,
    min(transaction_ts) as first_transaction_ts,   -- <---- FALTAN
    max(transaction_ts) as last_transaction_ts     -- <---- FALTAN
from "medallion"."main"."stg_transactions"
group by customer_id
    );
  
  
[0m13:36:46.726950 [debug] [Thread-3 (]: SQL status: OK in 0.031 seconds
[0m13:36:46.730900 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:36:46.731564 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions__dbt_tmp" rename to "fct_customer_transactions"
[0m13:36:46.732665 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:36:46.739893 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m13:36:46.740962 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:36:46.741838 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m13:36:46.748007 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:36:46.752723 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m13:36:46.753903 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

      drop table if exists "medallion"."main"."fct_customer_transactions__dbt_backup" cascade
    
[0m13:36:46.755815 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:36:46.758708 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m13:36:46.759726 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb574232-11d2-4507-856f-fb93576f4e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c3f3dd50>]}
[0m13:36:46.760802 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.fct_customer_transactions ............... [[32mOK[0m in 0.10s]
[0m13:36:46.761717 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m13:36:46.763303 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:46.764093 [debug] [MainThread]: On master: BEGIN
[0m13:36:46.764703 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:36:46.765768 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:36:46.766340 [debug] [MainThread]: On master: COMMIT
[0m13:36:46.766916 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:46.767489 [debug] [MainThread]: On master: COMMIT
[0m13:36:46.768463 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:46.769035 [debug] [MainThread]: On master: Close
[0m13:36:46.769739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:46.770228 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m13:36:46.770785 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m13:36:46.771440 [info ] [MainThread]: 
[0m13:36:46.772066 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m13:36:46.773275 [debug] [MainThread]: Command end result
[0m13:36:46.806524 [debug] [MainThread]: Wrote artifact WritableManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/manifest.json
[0m13:36:46.808504 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/semantic_manifest.json
[0m13:36:46.816193 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/run_results.json
[0m13:36:46.816689 [info ] [MainThread]: 
[0m13:36:46.817276 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:36:46.817778 [info ] [MainThread]: 
[0m13:36:46.818300 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:36:46.819313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4485264, "process_in_blocks": "97936", "process_kernel_time": 0.192158, "process_mem_max_rss": "158628", "process_out_blocks": "3384", "process_user_time": 3.517591}
[0m13:36:46.819949 [debug] [MainThread]: Command `dbt run` succeeded at 13:36:46.819823 after 2.45 seconds
[0m13:36:46.820503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60b2ac190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60b2d1960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60cce5f90>]}
[0m13:36:46.821108 [debug] [MainThread]: Flushing usage events
[0m13:36:48.285838 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:51.499641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cb22d740d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cb21e5b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cb21e59480>]}


============================== 13:36:51.502711 | 612f7bd6-07f7-4805-b39d-b7ab51e08a0a ==============================
[0m13:36:51.502711 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:36:51.503392 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'write_json': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test --project-dir /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt', 'profiles_dir': '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/profiles', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'printer_width': '80', 'log_path': '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/logs', 'no_print': 'None', 'empty': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'fail_fast': 'False', 'debug': 'False', 'static_parser': 'True', 'use_colors': 'True'}
[0m13:36:51.793834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '612f7bd6-07f7-4805-b39d-b7ab51e08a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cb2474e200>]}
[0m13:36:51.877693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '612f7bd6-07f7-4805-b39d-b7ab51e08a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cb21ba3c40>]}
[0m13:36:51.879857 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:36:51.992765 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:36:52.147602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:52.148153 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:52.210786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '612f7bd6-07f7-4805-b39d-b7ab51e08a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cb19dd8130>]}
[0m13:36:52.381381 [debug] [MainThread]: Wrote artifact WritableManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/manifest.json
[0m13:36:52.383361 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/semantic_manifest.json
[0m13:36:52.429524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '612f7bd6-07f7-4805-b39d-b7ab51e08a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cb19d58400>]}
[0m13:36:52.430260 [info ] [MainThread]: Found 2 models, 29 data tests, 454 macros
[0m13:36:52.430815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '612f7bd6-07f7-4805-b39d-b7ab51e08a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cb1a02f1f0>]}
[0m13:36:52.434513 [info ] [MainThread]: 
[0m13:36:52.435105 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:36:52.435622 [info ] [MainThread]: 
[0m13:36:52.436320 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:36:52.443134 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m13:36:52.487139 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:36:52.488148 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m13:36:52.488803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:52.506417 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m13:36:52.507094 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m13:36:52.507660 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m13:36:52.521364 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:36:52.524146 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m13:36:52.525062 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m13:36:52.525654 [debug] [ThreadPool]: On list_medallion_main: Close
[0m13:36:52.526989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '612f7bd6-07f7-4805-b39d-b7ab51e08a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cb19d59ea0>]}
[0m13:36:52.527705 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:52.528220 [debug] [MainThread]: On master: BEGIN
[0m13:36:52.528729 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:52.529616 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:36:52.530135 [debug] [MainThread]: On master: COMMIT
[0m13:36:52.530675 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:52.531177 [debug] [MainThread]: On master: COMMIT
[0m13:36:52.531901 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:52.532403 [debug] [MainThread]: On master: Close
[0m13:36:52.535893 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9
[0m13:36:52.536513 [debug] [Thread-2 (]: Began running node test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609
[0m13:36:52.537122 [info ] [Thread-1 (]: 1 of 29 START test accepted_status_stg_transactions_status ..................... [RUN]
[0m13:36:52.537869 [info ] [Thread-2 (]: 2 of 29 START test amount_not_outlier_stg_transactions_amount .................. [RUN]
[0m13:36:52.538774 [debug] [Thread-3 (]: Began running node test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316
[0m13:36:52.539537 [debug] [Thread-4 (]: Began running node test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de
[0m13:36:52.540452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9)
[0m13:36:52.541294 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609'
[0m13:36:52.542004 [info ] [Thread-3 (]: 3 of 29 START test customer_exists_in_silver_fct_customer_transactions_customer_id  [RUN]
[0m13:36:52.542684 [info ] [Thread-4 (]: 4 of 29 START test no_duplicate_rows_stg_transactions_ ......................... [RUN]
[0m13:36:52.543420 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9
[0m13:36:52.544164 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609
[0m13:36:52.544934 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316'
[0m13:36:52.545650 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de'
[0m13:36:52.562958 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"
[0m13:36:52.568731 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"
[0m13:36:52.569457 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316
[0m13:36:52.570085 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de
[0m13:36:52.571476 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9
[0m13:36:52.572628 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609
[0m13:36:52.584397 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"
[0m13:36:52.599796 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"
[0m13:36:52.671624 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"
[0m13:36:52.672781 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"
[0m13:36:52.673701 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316
[0m13:36:52.674542 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de
[0m13:36:52.678433 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"
[0m13:36:52.679330 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"
[0m13:36:52.682715 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"
[0m13:36:52.683343 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"
[0m13:36:52.684209 [debug] [Thread-2 (]: On test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609: BEGIN
[0m13:36:52.685058 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9: BEGIN
[0m13:36:52.685731 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"
[0m13:36:52.686354 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:36:52.686940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:52.687627 [debug] [Thread-3 (]: On test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316: BEGIN
[0m13:36:52.688561 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"
[0m13:36:52.689975 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:36:52.690654 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:36:52.691252 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:36:52.691822 [debug] [Thread-4 (]: On test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de: BEGIN
[0m13:36:52.692640 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"
[0m13:36:52.693295 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:36:52.693862 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"
[0m13:36:52.694459 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:36:52.695061 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select status
from "medallion"."main"."stg_transactions"
where status not in ('completed', 'pending', 'failed')


  
  
      
    ) dbt_internal_test
[0m13:36:52.695693 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"
[0m13:36:52.696306 [debug] [Thread-2 (]: On test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select amount
from "medallion"."main"."stg_transactions"
where amount > 100000


  
  
      
    ) dbt_internal_test
[0m13:36:52.697534 [debug] [Thread-3 (]: On test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with silver as (
    select distinct customer_id
    from "medallion"."main"."stg_transactions"
)
select g.customer_id
from "medallion"."main"."fct_customer_transactions" g
left join silver s
    on g.customer_id = s.customer_id
where s.customer_id is null


  
  
      
    ) dbt_internal_test
[0m13:36:52.698192 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:36:52.699285 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"
[0m13:36:52.700038 [debug] [Thread-4 (]: On test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select *
from "medallion"."main"."stg_transactions"
group by *
having count(*) > 1


  
  
      
    ) dbt_internal_test
[0m13:36:52.700915 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:36:52.701502 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:36:52.708528 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9: ROLLBACK
[0m13:36:52.709213 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m13:36:52.709820 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m13:36:52.711794 [debug] [Thread-2 (]: On test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609: ROLLBACK
[0m13:36:52.712534 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9'
[0m13:36:52.714868 [debug] [Thread-4 (]: On test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de: ROLLBACK
[0m13:36:52.716616 [debug] [Thread-3 (]: On test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316: ROLLBACK
[0m13:36:52.717218 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9: Close
[0m13:36:52.717902 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609'
[0m13:36:52.718590 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de'
[0m13:36:52.719257 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316'
[0m13:36:52.719949 [debug] [Thread-2 (]: On test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609: Close
[0m13:36:52.720788 [info ] [Thread-1 (]: 1 of 29 PASS accepted_status_stg_transactions_status ........................... [[32mPASS[0m in 0.18s]
[0m13:36:52.721463 [debug] [Thread-4 (]: On test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de: Close
[0m13:36:52.722143 [debug] [Thread-3 (]: On test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316: Close
[0m13:36:52.723193 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9
[0m13:36:52.724073 [info ] [Thread-2 (]: 2 of 29 PASS amount_not_outlier_stg_transactions_amount ........................ [[32mPASS[0m in 0.18s]
[0m13:36:52.724988 [info ] [Thread-4 (]: 4 of 29 PASS no_duplicate_rows_stg_transactions_ ............................... [[32mPASS[0m in 0.18s]
[0m13:36:52.725807 [info ] [Thread-3 (]: 3 of 29 PASS customer_exists_in_silver_fct_customer_transactions_customer_id ... [[32mPASS[0m in 0.18s]
[0m13:36:52.726531 [debug] [Thread-1 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m13:36:52.727409 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609
[0m13:36:52.728282 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de
[0m13:36:52.729114 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316
[0m13:36:52.729801 [info ] [Thread-1 (]: 5 of 29 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m13:36:52.730476 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m13:36:52.731088 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m13:36:52.731765 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m13:36:52.732507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9, now test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89)
[0m13:36:52.733102 [info ] [Thread-2 (]: 6 of 29 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m13:36:52.733833 [info ] [Thread-4 (]: 7 of 29 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m13:36:52.734501 [info ] [Thread-3 (]: 8 of 29 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m13:36:52.735147 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m13:36:52.735784 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609, now test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428)
[0m13:36:52.736462 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de, now test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4)
[0m13:36:52.737073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m13:36:52.744239 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m13:36:52.744999 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m13:36:52.745690 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m13:36:52.746486 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m13:36:52.752236 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m13:36:52.758410 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m13:36:52.761014 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m13:36:52.766694 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m13:36:52.770270 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m13:36:52.771225 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m13:36:52.772324 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m13:36:52.773008 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m13:36:52.773730 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m13:36:52.777107 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m13:36:52.780714 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m13:36:52.783840 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m13:36:52.784510 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m13:36:52.785813 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m13:36:52.786593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:52.787223 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m13:36:52.788058 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m13:36:52.789249 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m13:36:52.790774 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m13:36:52.791660 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:36:52.792674 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:36:52.793426 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m13:36:52.794165 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:52.795247 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m13:36:52.796114 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:36:52.796844 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:52.797917 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m13:36:52.798629 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m13:36:52.799313 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:36:52.800378 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:36:52.801164 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m13:36:52.801841 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:36:52.802478 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m13:36:52.803186 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m13:36:52.805935 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m13:36:52.806659 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m13:36:52.807297 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:36:52.807947 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m13:36:52.808681 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m13:36:52.810947 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m13:36:52.811814 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:36:52.812489 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m13:36:52.813215 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:36:52.813899 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m13:36:52.816151 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m13:36:52.817061 [info ] [Thread-1 (]: 5 of 29 PASS non_negative_fct_customer_transactions_total_amount_all ........... [[32mPASS[0m in 0.08s]
[0m13:36:52.819225 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m13:36:52.819860 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m13:36:52.820591 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m13:36:52.821729 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m13:36:52.823002 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m13:36:52.824099 [info ] [Thread-4 (]: 7 of 29 PASS non_negative_fct_customer_transactions_transaction_count .......... [[32mPASS[0m in 0.09s]
[0m13:36:52.824765 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m13:36:52.825559 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36
[0m13:36:52.826505 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m13:36:52.827487 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m13:36:52.828752 [info ] [Thread-2 (]: 6 of 29 PASS non_negative_fct_customer_transactions_total_amount_completed ..... [[32mPASS[0m in 0.09s]
[0m13:36:52.829586 [info ] [Thread-1 (]: 9 of 29 START test not_in_future_stg_transactions_transaction_ts ............... [RUN]
[0m13:36:52.830744 [info ] [Thread-3 (]: 8 of 29 PASS non_negative_stg_transactions_amount .............................. [[32mPASS[0m in 0.09s]
[0m13:36:52.831477 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m13:36:52.832482 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m13:36:52.833268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36)
[0m13:36:52.834136 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m13:36:52.834858 [info ] [Thread-4 (]: 10 of 29 START test not_null_fct_customer_transactions_customer_id ............. [RUN]
[0m13:36:52.835733 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2
[0m13:36:52.836785 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36
[0m13:36:52.837555 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a
[0m13:36:52.838371 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m13:36:52.839173 [info ] [Thread-2 (]: 11 of 29 START test not_null_fct_customer_transactions_first_transaction_ts .... [RUN]
[0m13:36:52.847835 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"
[0m13:36:52.848738 [info ] [Thread-3 (]: 12 of 29 START test not_null_fct_customer_transactions_last_transaction_ts ..... [RUN]
[0m13:36:52.849481 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m13:36:52.850343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2)
[0m13:36:52.851520 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a)
[0m13:36:52.860696 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m13:36:52.861658 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36
[0m13:36:52.862737 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2
[0m13:36:52.863832 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a
[0m13:36:52.868905 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"
[0m13:36:52.870057 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m13:36:52.877080 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"
[0m13:36:52.882362 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"
[0m13:36:52.887784 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m13:36:52.889126 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"
[0m13:36:52.890288 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2
[0m13:36:52.891097 [debug] [Thread-1 (]: On test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36: BEGIN
[0m13:36:52.891926 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a
[0m13:36:52.895860 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"
[0m13:36:52.896694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:52.897524 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m13:36:52.903056 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"
[0m13:36:52.904137 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"
[0m13:36:52.905217 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m13:36:52.906303 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m13:36:52.907045 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2: BEGIN
[0m13:36:52.907764 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"
[0m13:36:52.908456 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:36:52.909341 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"
[0m13:36:52.910003 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:52.910661 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a: BEGIN
[0m13:36:52.911694 [debug] [Thread-1 (]: On test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts > current_timestamp


  
  
      
    ) dbt_internal_test
[0m13:36:52.912658 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:36:52.913555 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:52.914289 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:36:52.915126 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m13:36:52.916396 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"
[0m13:36:52.917193 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:36:52.918099 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:36:52.918921 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_transaction_ts
from "medallion"."main"."fct_customer_transactions"
where first_transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m13:36:52.919968 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:36:52.920674 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"
[0m13:36:52.921241 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:36:52.922233 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_transaction_ts
from "medallion"."main"."fct_customer_transactions"
where last_transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m13:36:52.924114 [debug] [Thread-1 (]: On test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36: ROLLBACK
[0m13:36:52.924827 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:36:52.927374 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m13:36:52.928590 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36'
[0m13:36:52.930607 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2: ROLLBACK
[0m13:36:52.931303 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:36:52.932200 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m13:36:52.933035 [debug] [Thread-1 (]: On test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36: Close
[0m13:36:52.933834 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2'
[0m13:36:52.934575 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m13:36:52.936268 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a: ROLLBACK
[0m13:36:52.937174 [info ] [Thread-1 (]: 9 of 29 PASS not_in_future_stg_transactions_transaction_ts ..................... [[32mPASS[0m in 0.10s]
[0m13:36:52.937761 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2: Close
[0m13:36:52.938638 [info ] [Thread-4 (]: 10 of 29 PASS not_null_fct_customer_transactions_customer_id ................... [[32mPASS[0m in 0.10s]
[0m13:36:52.939287 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a'
[0m13:36:52.940068 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36
[0m13:36:52.940829 [info ] [Thread-2 (]: 11 of 29 PASS not_null_fct_customer_transactions_first_transaction_ts .......... [[32mPASS[0m in 0.09s]
[0m13:36:52.941655 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m13:36:52.942205 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a: Close
[0m13:36:52.942870 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m13:36:52.943643 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2
[0m13:36:52.944336 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m13:36:52.945153 [info ] [Thread-3 (]: 12 of 29 PASS not_null_fct_customer_transactions_last_transaction_ts ........... [[32mPASS[0m in 0.09s]
[0m13:36:52.945840 [info ] [Thread-1 (]: 13 of 29 START test not_null_fct_customer_transactions_total_amount_all ........ [RUN]
[0m13:36:52.946498 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m13:36:52.947166 [info ] [Thread-4 (]: 14 of 29 START test not_null_fct_customer_transactions_total_amount_completed .. [RUN]
[0m13:36:52.947983 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a
[0m13:36:52.948658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m13:36:52.949285 [info ] [Thread-2 (]: 15 of 29 START test not_null_fct_customer_transactions_transaction_count ....... [RUN]
[0m13:36:52.950037 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m13:36:52.950895 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m13:36:52.951662 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m13:36:52.952355 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m13:36:52.952950 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m13:36:52.953536 [info ] [Thread-3 (]: 16 of 29 START test not_null_stg_transactions_amount ........................... [RUN]
[0m13:36:52.958755 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m13:36:52.959427 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m13:36:52.964315 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m13:36:52.965085 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m13:36:52.970059 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m13:36:52.970803 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m13:36:52.971501 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m13:36:52.972192 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m13:36:52.977216 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m13:36:52.977912 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m13:36:52.980819 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m13:36:52.983743 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m13:36:52.987981 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m13:36:52.988621 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m13:36:52.989764 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m13:36:52.990351 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m13:36:52.990942 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m13:36:52.993907 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m13:36:52.994555 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m13:36:52.995163 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m13:36:52.995733 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m13:36:52.996409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:52.997070 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:36:52.997623 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:52.998212 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m13:36:52.999430 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m13:36:53.000013 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:36:53.000562 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:53.001159 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:36:53.001781 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m13:36:53.002346 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:36:53.003150 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m13:36:53.003785 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:36:53.004399 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m13:36:53.005034 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m13:36:53.005674 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m13:36:53.006324 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m13:36:53.007135 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m13:36:53.007973 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:36:53.008599 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m13:36:53.009214 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:36:53.011513 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m13:36:53.012201 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:36:53.012920 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:36:53.014538 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m13:36:53.015278 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m13:36:53.017218 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m13:36:53.017845 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m13:36:53.018421 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m13:36:53.019065 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m13:36:53.020649 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m13:36:53.021170 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m13:36:53.022069 [info ] [Thread-1 (]: 13 of 29 PASS not_null_fct_customer_transactions_total_amount_all .............. [[32mPASS[0m in 0.07s]
[0m13:36:53.022708 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m13:36:53.023633 [info ] [Thread-4 (]: 14 of 29 PASS not_null_fct_customer_transactions_total_amount_completed ........ [[32mPASS[0m in 0.07s]
[0m13:36:53.024260 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m13:36:53.025056 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m13:36:53.025887 [info ] [Thread-3 (]: 16 of 29 PASS not_null_stg_transactions_amount ................................. [[32mPASS[0m in 0.06s]
[0m13:36:53.026699 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m13:36:53.027316 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m13:36:53.027987 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m13:36:53.028914 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m13:36:53.029562 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m13:36:53.030344 [info ] [Thread-1 (]: 17 of 29 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m13:36:53.031189 [info ] [Thread-2 (]: 15 of 29 PASS not_null_fct_customer_transactions_transaction_count ............. [[32mPASS[0m in 0.08s]
[0m13:36:53.031857 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m13:36:53.032553 [info ] [Thread-4 (]: 18 of 29 START test not_null_stg_transactions_status ........................... [RUN]
[0m13:36:53.033208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m13:36:53.034045 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m13:36:53.034619 [info ] [Thread-3 (]: 19 of 29 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m13:36:53.035307 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m13:36:53.035874 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m13:36:53.036525 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m13:36:53.037204 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m13:36:53.037816 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m13:36:53.042560 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m13:36:53.043200 [info ] [Thread-2 (]: 20 of 29 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m13:36:53.043836 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m13:36:53.048228 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m13:36:53.049108 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m13:36:53.056569 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m13:36:53.057573 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m13:36:53.058218 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m13:36:53.059001 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m13:36:53.062239 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m13:36:53.062894 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m13:36:53.071031 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m13:36:53.071728 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m13:36:53.075937 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m13:36:53.076982 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m13:36:53.077945 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m13:36:53.078733 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m13:36:53.079320 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m13:36:53.079991 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m13:36:53.083421 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m13:36:53.084083 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m13:36:53.084657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:53.085309 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m13:36:53.086109 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:36:53.086932 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m13:36:53.087763 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:53.088577 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:36:53.089164 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m13:36:53.089859 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:36:53.090462 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m13:36:53.091085 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:36:53.091605 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:53.092166 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m13:36:53.092753 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:36:53.093408 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m13:36:53.094397 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m13:36:53.095141 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:36:53.095868 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m13:36:53.096602 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:36:53.097331 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m13:36:53.098220 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:36:53.098933 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m13:36:53.100791 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m13:36:53.101642 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:36:53.104593 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m13:36:53.105402 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m13:36:53.106245 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:36:53.108052 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m13:36:53.108756 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m13:36:53.109349 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m13:36:53.111488 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m13:36:53.112149 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m13:36:53.112727 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m13:36:53.113686 [info ] [Thread-1 (]: 17 of 29 PASS not_null_stg_transactions_customer_id ............................ [[32mPASS[0m in 0.08s]
[0m13:36:53.114331 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m13:36:53.114893 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m13:36:53.115743 [info ] [Thread-4 (]: 18 of 29 PASS not_null_stg_transactions_status ................................. [[32mPASS[0m in 0.08s]
[0m13:36:53.116577 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m13:36:53.117268 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m13:36:53.118228 [info ] [Thread-3 (]: 19 of 29 PASS not_null_stg_transactions_transaction_date ....................... [[32mPASS[0m in 0.08s]
[0m13:36:53.119146 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m13:36:53.119793 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m13:36:53.120807 [info ] [Thread-2 (]: 20 of 29 PASS not_null_stg_transactions_transaction_id ......................... [[32mPASS[0m in 0.07s]
[0m13:36:53.121600 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m13:36:53.122249 [debug] [Thread-4 (]: Began running node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9
[0m13:36:53.122887 [info ] [Thread-1 (]: 21 of 29 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m13:36:53.123704 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m13:36:53.124349 [debug] [Thread-3 (]: Began running node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4
[0m13:36:53.125041 [info ] [Thread-4 (]: 22 of 29 START test total_amount_non_negative_fct_customer_transactions_total_amount_all  [RUN]
[0m13:36:53.125780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m13:36:53.126430 [debug] [Thread-2 (]: Began running node test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262
[0m13:36:53.127129 [info ] [Thread-3 (]: 23 of 29 START test total_amount_non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m13:36:53.127863 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9)
[0m13:36:53.128518 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m13:36:53.129121 [info ] [Thread-2 (]: 24 of 29 START test transaction_count_positive_fct_customer_transactions_transaction_count  [RUN]
[0m13:36:53.129819 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c, now test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4)
[0m13:36:53.130467 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9
[0m13:36:53.135485 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m13:36:53.136193 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4, now test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262)
[0m13:36:53.136828 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4
[0m13:36:53.142791 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"
[0m13:36:53.143497 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262
[0m13:36:53.144218 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m13:36:53.149140 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"
[0m13:36:53.156999 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"
[0m13:36:53.157792 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9
[0m13:36:53.161092 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m13:36:53.162097 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4
[0m13:36:53.165403 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"
[0m13:36:53.166207 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262
[0m13:36:53.169323 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"
[0m13:36:53.173183 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"
[0m13:36:53.174010 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m13:36:53.174720 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"
[0m13:36:53.175817 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"
[0m13:36:53.176596 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m13:36:53.177195 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"
[0m13:36:53.177817 [debug] [Thread-4 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9: BEGIN
[0m13:36:53.178577 [debug] [Thread-3 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4: BEGIN
[0m13:36:53.179189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:53.179765 [debug] [Thread-2 (]: On test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262: BEGIN
[0m13:36:53.180401 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:36:53.181033 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:53.181948 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:53.182597 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:36:53.183559 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:36:53.184318 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:36:53.184871 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m13:36:53.185505 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:36:53.186124 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"
[0m13:36:53.186844 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"
[0m13:36:53.187596 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m13:36:53.188502 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"
[0m13:36:53.189187 [debug] [Thread-4 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0


  
  
      
    ) dbt_internal_test
[0m13:36:53.189910 [debug] [Thread-3 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0


  
  
      
    ) dbt_internal_test
[0m13:36:53.190796 [debug] [Thread-2 (]: On test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count <= 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m13:36:53.192065 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:36:53.192803 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:36:53.193385 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:36:53.194122 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:36:53.196107 [debug] [Thread-3 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4: ROLLBACK
[0m13:36:53.197859 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m13:36:53.199549 [debug] [Thread-2 (]: On test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262: ROLLBACK
[0m13:36:53.200325 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4'
[0m13:36:53.201921 [debug] [Thread-4 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9: ROLLBACK
[0m13:36:53.202591 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m13:36:53.203416 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262'
[0m13:36:53.204258 [debug] [Thread-3 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4: Close
[0m13:36:53.204985 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9'
[0m13:36:53.205617 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m13:36:53.206326 [debug] [Thread-2 (]: On test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262: Close
[0m13:36:53.207567 [info ] [Thread-3 (]: 23 of 29 PASS total_amount_non_negative_fct_customer_transactions_total_amount_completed  [[32mPASS[0m in 0.08s]
[0m13:36:53.208245 [debug] [Thread-4 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9: Close
[0m13:36:53.209193 [info ] [Thread-1 (]: 21 of 29 PASS not_null_stg_transactions_transaction_ts ......................... [[32mPASS[0m in 0.08s]
[0m13:36:53.209984 [info ] [Thread-2 (]: 24 of 29 PASS transaction_count_positive_fct_customer_transactions_transaction_count  [[32mPASS[0m in 0.07s]
[0m13:36:53.210823 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4
[0m13:36:53.211728 [info ] [Thread-4 (]: 22 of 29 PASS total_amount_non_negative_fct_customer_transactions_total_amount_all  [[32mPASS[0m in 0.08s]
[0m13:36:53.212563 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m13:36:53.213321 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262
[0m13:36:53.213974 [debug] [Thread-3 (]: Began running node test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e
[0m13:36:53.215019 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9
[0m13:36:53.215625 [debug] [Thread-1 (]: Began running node test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40
[0m13:36:53.216299 [debug] [Thread-2 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m13:36:53.216982 [info ] [Thread-3 (]: 25 of 29 START test unique_customer_rows_fct_customer_transactions_ ............ [RUN]
[0m13:36:53.217635 [debug] [Thread-4 (]: Began running node test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc
[0m13:36:53.218297 [info ] [Thread-1 (]: 26 of 29 START test unique_fct_customer_transactions_customer_id ............... [RUN]
[0m13:36:53.218969 [info ] [Thread-2 (]: 27 of 29 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m13:36:53.219737 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4, now test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e)
[0m13:36:53.220423 [info ] [Thread-4 (]: 28 of 29 START test unique_transaction_id_stg_transactions_transaction_id ...... [RUN]
[0m13:36:53.221130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7, now test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40)
[0m13:36:53.221796 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m13:36:53.222497 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e
[0m13:36:53.223167 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9, now test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc)
[0m13:36:53.223755 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40
[0m13:36:53.224302 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m13:36:53.229978 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"
[0m13:36:53.230678 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc
[0m13:36:53.238192 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"
[0m13:36:53.244555 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m13:36:53.250817 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"
[0m13:36:53.251608 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e
[0m13:36:53.252535 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc
[0m13:36:53.253190 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m13:36:53.253747 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40
[0m13:36:53.256988 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"
[0m13:36:53.260487 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"
[0m13:36:53.265212 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m13:36:53.268791 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"
[0m13:36:53.269982 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"
[0m13:36:53.270602 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"
[0m13:36:53.271380 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m13:36:53.271987 [debug] [Thread-3 (]: On test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e: BEGIN
[0m13:36:53.272651 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"
[0m13:36:53.273228 [debug] [Thread-4 (]: On test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc: BEGIN
[0m13:36:53.273813 [debug] [Thread-2 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m13:36:53.274358 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:53.274959 [debug] [Thread-1 (]: On test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40: BEGIN
[0m13:36:53.275506 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:36:53.276083 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:53.276886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:53.277582 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:36:53.278293 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:36:53.279007 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:36:53.279583 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"
[0m13:36:53.280134 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"
[0m13:36:53.280683 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:36:53.281298 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m13:36:53.282039 [debug] [Thread-3 (]: On test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select customer_id
from "medallion"."main"."fct_customer_transactions"
group by customer_id
having count(*) > 1


  
  
      
    ) dbt_internal_test
[0m13:36:53.282654 [debug] [Thread-4 (]: On test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select transaction_id
from "medallion"."main"."stg_transactions"
group by transaction_id
having count(*) > 1


  
  
      
    ) dbt_internal_test
[0m13:36:53.283273 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"
[0m13:36:53.283863 [debug] [Thread-2 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:36:53.284950 [debug] [Thread-1 (]: On test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "medallion"."main"."fct_customer_transactions"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:36:53.285941 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:36:53.286664 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:36:53.288427 [debug] [Thread-3 (]: On test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e: ROLLBACK
[0m13:36:53.289096 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:36:53.289695 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:36:53.291306 [debug] [Thread-4 (]: On test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc: ROLLBACK
[0m13:36:53.291972 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e'
[0m13:36:53.293617 [debug] [Thread-1 (]: On test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40: ROLLBACK
[0m13:36:53.294352 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc'
[0m13:36:53.295884 [debug] [Thread-2 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m13:36:53.296498 [debug] [Thread-3 (]: On test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e: Close
[0m13:36:53.297203 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40'
[0m13:36:53.298062 [debug] [Thread-4 (]: On test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc: Close
[0m13:36:53.298868 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m13:36:53.299459 [debug] [Thread-1 (]: On test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40: Close
[0m13:36:53.300319 [info ] [Thread-3 (]: 25 of 29 PASS unique_customer_rows_fct_customer_transactions_ .................. [[32mPASS[0m in 0.08s]
[0m13:36:53.301244 [info ] [Thread-4 (]: 28 of 29 PASS unique_transaction_id_stg_transactions_transaction_id ............ [[32mPASS[0m in 0.08s]
[0m13:36:53.301901 [debug] [Thread-2 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m13:36:53.302716 [info ] [Thread-1 (]: 26 of 29 PASS unique_fct_customer_transactions_customer_id ..................... [[32mPASS[0m in 0.08s]
[0m13:36:53.303579 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e
[0m13:36:53.304374 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc
[0m13:36:53.305273 [info ] [Thread-2 (]: 27 of 29 PASS unique_stg_transactions_transaction_id ........................... [[32mPASS[0m in 0.08s]
[0m13:36:53.306054 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40
[0m13:36:53.306714 [debug] [Thread-3 (]: Began running node test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518
[0m13:36:53.307685 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m13:36:53.308372 [info ] [Thread-3 (]: 29 of 29 START test valid_timestamp_stg_transactions_transaction_ts ............ [RUN]
[0m13:36:53.309276 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e, now test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518)
[0m13:36:53.309851 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518
[0m13:36:53.318264 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"
[0m13:36:53.319630 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518
[0m13:36:53.323082 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"
[0m13:36:53.324233 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"
[0m13:36:53.324909 [debug] [Thread-3 (]: On test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518: BEGIN
[0m13:36:53.325467 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:53.326458 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:36:53.327086 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"
[0m13:36:53.327679 [debug] [Thread-3 (]: On test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null


  
  
      
    ) dbt_internal_test
[0m13:36:53.329577 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:36:53.331563 [debug] [Thread-3 (]: On test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518: ROLLBACK
[0m13:36:53.332417 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518'
[0m13:36:53.333241 [debug] [Thread-3 (]: On test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518: Close
[0m13:36:53.334456 [info ] [Thread-3 (]: 29 of 29 PASS valid_timestamp_stg_transactions_transaction_ts .................. [[32mPASS[0m in 0.03s]
[0m13:36:53.335796 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518
[0m13:36:53.338010 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:53.338667 [debug] [MainThread]: On master: BEGIN
[0m13:36:53.339243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:36:53.340320 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:36:53.340862 [debug] [MainThread]: On master: COMMIT
[0m13:36:53.341358 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:53.341853 [debug] [MainThread]: On master: COMMIT
[0m13:36:53.342540 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:53.343059 [debug] [MainThread]: On master: Close
[0m13:36:53.343734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:53.344208 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40' was properly closed.
[0m13:36:53.344705 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m13:36:53.350757 [debug] [MainThread]: Connection 'test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518' was properly closed.
[0m13:36:53.351725 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc' was properly closed.
[0m13:36:53.352677 [info ] [MainThread]: 
[0m13:36:53.353401 [info ] [MainThread]: Finished running 29 data tests in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m13:36:53.360111 [debug] [MainThread]: Command end result
[0m13:36:53.395220 [debug] [MainThread]: Wrote artifact WritableManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/manifest.json
[0m13:36:53.397359 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/semantic_manifest.json
[0m13:36:53.408584 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/run_results.json
[0m13:36:53.409205 [info ] [MainThread]: 
[0m13:36:53.409806 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:36:53.410333 [info ] [MainThread]: 
[0m13:36:53.410865 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=29
[0m13:36:53.412014 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9906658, "process_in_blocks": "2752", "process_kernel_time": 0.166327, "process_mem_max_rss": "159876", "process_out_blocks": "2944", "process_user_time": 3.411718}
[0m13:36:53.412684 [debug] [MainThread]: Command `dbt test` succeeded at 13:36:53.412561 after 1.99 seconds
[0m13:36:53.413250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cb22d740d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cb2474e200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cb07fe5c60>]}
[0m13:36:53.413861 [debug] [MainThread]: Flushing usage events
[0m13:36:54.110912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:00:17.192672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0abd2b0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0abd160d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0abc1bb670>]}


============================== 11:00:17.195845 | eeb24df0-7a55-46ec-8119-cdbf84a67a1a ==============================
[0m11:00:17.195845 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:00:17.196527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --project-dir /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'profiles_dir': '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/profiles', 'fail_fast': 'False', 'empty': 'False', 'log_path': '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False'}
[0m11:00:17.469513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eeb24df0-7a55-46ec-8119-cdbf84a67a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0abed1df60>]}
[0m11:00:17.555764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eeb24df0-7a55-46ec-8119-cdbf84a67a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0abc252770>]}
[0m11:00:17.558044 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:00:17.677487 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:00:17.843839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m11:00:17.844757 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/schema.yml
[0m11:00:17.845411 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/schema.yml
[0m11:00:17.846122 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/fct_customer_transactions.sql
[0m11:00:17.846813 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m11:00:18.511154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eeb24df0-7a55-46ec-8119-cdbf84a67a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0aa5f75ab0>]}
[0m11:00:18.606481 [debug] [MainThread]: Wrote artifact WritableManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/manifest.json
[0m11:00:18.608297 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/semantic_manifest.json
[0m11:00:18.621017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eeb24df0-7a55-46ec-8119-cdbf84a67a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0ab429fd60>]}
[0m11:00:18.621667 [info ] [MainThread]: Found 2 models, 29 data tests, 454 macros
[0m11:00:18.622155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eeb24df0-7a55-46ec-8119-cdbf84a67a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0ab429e680>]}
[0m11:00:18.624206 [info ] [MainThread]: 
[0m11:00:18.624695 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:00:18.625144 [info ] [MainThread]: 
[0m11:00:18.625783 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:00:18.632608 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m11:00:18.669299 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m11:00:18.669883 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m11:00:18.670348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:18.683441 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:00:18.685008 [debug] [ThreadPool]: On list_medallion: Close
[0m11:00:18.685900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m11:00:18.686517 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m11:00:18.694702 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:00:18.695216 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m11:00:18.695675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:18.696882 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:00:18.698321 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:00:18.698792 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m11:00:18.699460 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:00:18.699924 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:00:18.700381 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m11:00:18.701079 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:00:18.702089 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m11:00:18.702540 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:00:18.702992 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m11:00:18.703595 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:00:18.704082 [debug] [ThreadPool]: On create_medallion_main: Close
[0m11:00:18.705550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m11:00:18.712117 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m11:00:18.712612 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m11:00:18.713061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:18.713840 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:00:18.714287 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m11:00:18.714740 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m11:00:18.726105 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:00:18.727667 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m11:00:18.728415 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m11:00:18.728945 [debug] [ThreadPool]: On list_medallion_main: Close
[0m11:00:18.730359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eeb24df0-7a55-46ec-8119-cdbf84a67a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0abe049360>]}
[0m11:00:18.731078 [debug] [MainThread]: Using duckdb connection "master"
[0m11:00:18.731569 [debug] [MainThread]: On master: BEGIN
[0m11:00:18.732043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:00:18.732898 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:00:18.733416 [debug] [MainThread]: On master: COMMIT
[0m11:00:18.733929 [debug] [MainThread]: Using duckdb connection "master"
[0m11:00:18.734419 [debug] [MainThread]: On master: COMMIT
[0m11:00:18.735180 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:00:18.735694 [debug] [MainThread]: On master: Close
[0m11:00:18.738561 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m11:00:18.739300 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m11:00:18.739974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m11:00:18.740521 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m11:00:18.753322 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m11:00:18.754139 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m11:00:18.790753 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m11:00:18.791679 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:00:18.792252 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m11:00:18.792798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:18.793850 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:00:18.794387 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:00:18.794942 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/data/clean/transactions_20251201_clean.parquet'
    )
)

-- queries
select
    cast(transaction_id as integer) as transaction_id,
    cast(customer_id as integer) as customer_id,
    cast(amount as decimal(10, 2)) as amount,
    cast(status as varchar) as status,
    cast(transaction_ts as timestamp) as transaction_ts,
    cast(transaction_date as date) as transaction_date
from source
  );

[0m11:00:18.796289 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:00:18.804896 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:00:18.805533 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m11:00:18.806545 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:00:18.810309 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:00:18.810953 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m11:00:18.811961 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:00:18.825578 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m11:00:18.826165 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:00:18.826692 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m11:00:18.858733 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m11:00:18.865919 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:00:18.866493 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m11:00:18.871926 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:00:18.874967 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m11:00:18.877033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeb24df0-7a55-46ec-8119-cdbf84a67a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0ab7f6cb20>]}
[0m11:00:18.877907 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.14s]
[0m11:00:18.878748 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m11:00:18.879882 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m11:00:18.880584 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m11:00:18.881327 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m11:00:18.881895 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m11:00:18.885939 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m11:00:18.886675 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m11:00:18.912364 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m11:00:18.913514 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:00:18.914377 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m11:00:18.915204 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:00:18.916399 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:00:18.917119 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:00:18.917766 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select * from "medallion"."main"."stg_transactions"
)

-- queries

select
    customer_id,
    count(*) as transaction_count,
    sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
    sum(amount) as total_amount_all,
    min(transaction_ts) as first_transaction_ts,   
    max(transaction_ts) as last_transaction_ts     
from "medallion"."main"."stg_transactions"
group by customer_id
    );
  
  
[0m11:00:18.920986 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m11:00:18.927615 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:00:18.928247 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_customer_transactions'
  
[0m11:00:18.929349 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:00:18.930901 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:00:18.931474 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_customer_transactions'
  
[0m11:00:18.932539 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:00:18.936544 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:00:18.937407 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions" rename to "fct_customer_transactions__dbt_backup"
[0m11:00:18.938594 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:00:18.944230 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:00:18.944915 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions__dbt_tmp" rename to "fct_customer_transactions"
[0m11:00:18.945932 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:00:18.951346 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m11:00:18.951931 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:00:18.952483 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m11:00:18.956646 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:00:18.960393 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:00:18.961053 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

      drop table if exists "medallion"."main"."fct_customer_transactions__dbt_backup" cascade
    
[0m11:00:18.966054 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:00:18.967917 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m11:00:18.968752 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeb24df0-7a55-46ec-8119-cdbf84a67a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0aa61b0730>]}
[0m11:00:18.969666 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.fct_customer_transactions ............... [[32mOK[0m in 0.09s]
[0m11:00:18.970668 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m11:00:18.972495 [debug] [MainThread]: Using duckdb connection "master"
[0m11:00:18.973131 [debug] [MainThread]: On master: BEGIN
[0m11:00:18.973628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:00:18.974522 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:00:18.975039 [debug] [MainThread]: On master: COMMIT
[0m11:00:18.975542 [debug] [MainThread]: Using duckdb connection "master"
[0m11:00:18.976044 [debug] [MainThread]: On master: COMMIT
[0m11:00:18.976791 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:00:18.977292 [debug] [MainThread]: On master: Close
[0m11:00:18.977921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:18.978385 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m11:00:18.978852 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m11:00:18.979350 [info ] [MainThread]: 
[0m11:00:18.979877 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m11:00:18.980968 [debug] [MainThread]: Command end result
[0m11:00:19.097732 [debug] [MainThread]: Wrote artifact WritableManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/manifest.json
[0m11:00:19.099737 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/semantic_manifest.json
[0m11:00:19.108376 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/run_results.json
[0m11:00:19.109028 [info ] [MainThread]: 
[0m11:00:19.109714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:00:19.110303 [info ] [MainThread]: 
[0m11:00:19.110868 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m11:00:19.111960 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9944236, "process_in_blocks": "264", "process_kernel_time": 0.128898, "process_mem_max_rss": "161164", "process_out_blocks": "3384", "process_user_time": 3.473268}
[0m11:00:19.112618 [debug] [MainThread]: Command `dbt run` succeeded at 11:00:19.112494 after 2.00 seconds
[0m11:00:19.113175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0abd2b0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0aa5f231f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0abe08e2f0>]}
[0m11:00:19.113749 [debug] [MainThread]: Flushing usage events
[0m11:00:19.981441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:00:22.688466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fe7cac0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fe6bbb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fe6bb9480>]}


============================== 11:00:22.691626 | fa37ef29-ba66-4b47-89e3-70a6425997bb ==============================
[0m11:00:22.691626 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:00:22.692306 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'write_json': 'True', 'target_path': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'empty': 'None', 'profiles_dir': '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/profiles', 'static_parser': 'True', 'log_path': '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/logs', 'version_check': 'True', 'invocation_command': 'dbt test --project-dir /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True'}
[0m11:00:22.960270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa37ef29-ba66-4b47-89e3-70a6425997bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fe96e6200>]}
[0m11:00:23.036054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa37ef29-ba66-4b47-89e3-70a6425997bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fe2947c40>]}
[0m11:00:23.038080 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:00:23.140901 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:00:23.292294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:00:23.292850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:00:23.349255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa37ef29-ba66-4b47-89e3-70a6425997bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fdeb680d0>]}
[0m11:00:23.518100 [debug] [MainThread]: Wrote artifact WritableManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/manifest.json
[0m11:00:23.520087 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/semantic_manifest.json
[0m11:00:23.542588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa37ef29-ba66-4b47-89e3-70a6425997bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fdec79f90>]}
[0m11:00:23.543334 [info ] [MainThread]: Found 2 models, 29 data tests, 454 macros
[0m11:00:23.543862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa37ef29-ba66-4b47-89e3-70a6425997bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fdeb066e0>]}
[0m11:00:23.547279 [info ] [MainThread]: 
[0m11:00:23.547808 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:00:23.548274 [info ] [MainThread]: 
[0m11:00:23.548937 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:00:23.555453 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m11:00:23.593406 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m11:00:23.593984 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m11:00:23.594431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:23.607108 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:00:23.607694 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m11:00:23.608197 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m11:00:23.622101 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:00:23.623894 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m11:00:23.624794 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m11:00:23.625344 [debug] [ThreadPool]: On list_medallion_main: Close
[0m11:00:23.626666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa37ef29-ba66-4b47-89e3-70a6425997bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fdec7a0b0>]}
[0m11:00:23.627326 [debug] [MainThread]: Using duckdb connection "master"
[0m11:00:23.627811 [debug] [MainThread]: On master: BEGIN
[0m11:00:23.628283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:00:23.629150 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:00:23.629627 [debug] [MainThread]: On master: COMMIT
[0m11:00:23.630121 [debug] [MainThread]: Using duckdb connection "master"
[0m11:00:23.630588 [debug] [MainThread]: On master: COMMIT
[0m11:00:23.631233 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:00:23.631715 [debug] [MainThread]: On master: Close
[0m11:00:23.635097 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9
[0m11:00:23.635779 [debug] [Thread-2 (]: Began running node test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609
[0m11:00:23.636343 [info ] [Thread-1 (]: 1 of 29 START test accepted_status_stg_transactions_status ..................... [RUN]
[0m11:00:23.637028 [info ] [Thread-2 (]: 2 of 29 START test amount_not_outlier_stg_transactions_amount .................. [RUN]
[0m11:00:23.637653 [debug] [Thread-3 (]: Began running node test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316
[0m11:00:23.638311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9)
[0m11:00:23.639123 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609'
[0m11:00:23.639716 [debug] [Thread-4 (]: Began running node test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de
[0m11:00:23.640373 [info ] [Thread-3 (]: 3 of 29 START test customer_exists_in_silver_fct_customer_transactions_customer_id  [RUN]
[0m11:00:23.641016 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9
[0m11:00:23.641637 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609
[0m11:00:23.642265 [info ] [Thread-4 (]: 4 of 29 START test no_duplicate_rows_stg_transactions_ ......................... [RUN]
[0m11:00:23.643006 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316'
[0m11:00:23.658504 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"
[0m11:00:23.664144 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"
[0m11:00:23.664937 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de'
[0m11:00:23.665552 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316
[0m11:00:23.666565 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609
[0m11:00:23.667368 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9
[0m11:00:23.667955 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de
[0m11:00:23.675240 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"
[0m11:00:23.722002 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"
[0m11:00:23.724061 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"
[0m11:00:23.721646 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"
[0m11:00:23.725705 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316
[0m11:00:23.726375 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"
[0m11:00:23.727197 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"
[0m11:00:23.731431 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"
[0m11:00:23.732419 [debug] [Thread-2 (]: On test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609: BEGIN
[0m11:00:23.733077 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de
[0m11:00:23.733704 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9: BEGIN
[0m11:00:23.734628 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:00:23.735463 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"
[0m11:00:23.738987 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"
[0m11:00:23.739637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:23.740716 [debug] [Thread-3 (]: On test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316: BEGIN
[0m11:00:23.741464 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m11:00:23.742474 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"
[0m11:00:23.743157 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:00:23.743981 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"
[0m11:00:23.744565 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:00:23.745196 [debug] [Thread-4 (]: On test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de: BEGIN
[0m11:00:23.746089 [debug] [Thread-2 (]: On test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select amount
from "medallion"."main"."stg_transactions"
where amount > 100000


  
  
      
    ) dbt_internal_test
[0m11:00:23.746806 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:00:23.747603 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"
[0m11:00:23.748264 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:00:23.749270 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"
[0m11:00:23.749991 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select status
from "medallion"."main"."stg_transactions"
where status not in ('completed', 'pending', 'failed')


  
  
      
    ) dbt_internal_test
[0m11:00:23.750909 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m11:00:23.751575 [debug] [Thread-3 (]: On test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with silver as (
    select distinct customer_id
    from "medallion"."main"."stg_transactions"
)
select g.customer_id
from "medallion"."main"."fct_customer_transactions" g
left join silver s
    on g.customer_id = s.customer_id
where s.customer_id is null


  
  
      
    ) dbt_internal_test
[0m11:00:23.757706 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m11:00:23.757188 [debug] [Thread-2 (]: On test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609: ROLLBACK
[0m11:00:23.758949 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:00:23.759716 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"
[0m11:00:23.760544 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609'
[0m11:00:23.762954 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9: ROLLBACK
[0m11:00:23.763674 [debug] [Thread-4 (]: On test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select *
from "medallion"."main"."stg_transactions"
group by *
having count(*) > 1


  
  
      
    ) dbt_internal_test
[0m11:00:23.764321 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m11:00:23.764994 [debug] [Thread-2 (]: On test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609: Close
[0m11:00:23.765928 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9'
[0m11:00:23.768208 [debug] [Thread-3 (]: On test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316: ROLLBACK
[0m11:00:23.769232 [info ] [Thread-2 (]: 2 of 29 PASS amount_not_outlier_stg_transactions_amount ........................ [[32mPASS[0m in 0.13s]
[0m11:00:23.769883 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9: Close
[0m11:00:23.770515 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m11:00:23.771181 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316'
[0m11:00:23.772070 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609
[0m11:00:23.772990 [info ] [Thread-1 (]: 1 of 29 PASS accepted_status_stg_transactions_status ........................... [[32mPASS[0m in 0.13s]
[0m11:00:23.773787 [debug] [Thread-3 (]: On test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316: Close
[0m11:00:23.774431 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m11:00:23.775293 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9
[0m11:00:23.777130 [debug] [Thread-4 (]: On test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de: ROLLBACK
[0m11:00:23.778174 [info ] [Thread-3 (]: 3 of 29 PASS customer_exists_in_silver_fct_customer_transactions_customer_id ... [[32mPASS[0m in 0.14s]
[0m11:00:23.778854 [info ] [Thread-2 (]: 5 of 29 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m11:00:23.779550 [debug] [Thread-1 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m11:00:23.780319 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de'
[0m11:00:23.781245 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316
[0m11:00:23.781934 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609, now test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89)
[0m11:00:23.782611 [info ] [Thread-1 (]: 6 of 29 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m11:00:23.783305 [debug] [Thread-4 (]: On test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de: Close
[0m11:00:23.783986 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m11:00:23.784573 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m11:00:23.785434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9, now test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428)
[0m11:00:23.786264 [info ] [Thread-3 (]: 7 of 29 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m11:00:23.787107 [info ] [Thread-4 (]: 4 of 29 PASS no_duplicate_rows_stg_transactions_ ............................... [[32mPASS[0m in 0.12s]
[0m11:00:23.794329 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m11:00:23.794995 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m11:00:23.795664 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316, now test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4)
[0m11:00:23.796509 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de
[0m11:00:23.801159 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m11:00:23.801855 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m11:00:23.802406 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m11:00:23.803018 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m11:00:23.806205 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m11:00:23.810848 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m11:00:23.811455 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m11:00:23.812112 [info ] [Thread-4 (]: 8 of 29 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m11:00:23.815533 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m11:00:23.816184 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m11:00:23.816838 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m11:00:23.817437 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m11:00:23.818180 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m11:00:23.818816 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m11:00:23.821831 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m11:00:23.822406 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m11:00:23.823038 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:23.823661 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m11:00:23.829840 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m11:00:23.830491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:23.831247 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m11:00:23.831970 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m11:00:23.832861 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m11:00:23.833493 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m11:00:23.834075 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:00:23.837113 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m11:00:23.837743 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m11:00:23.838340 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:00:23.838956 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m11:00:23.839695 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m11:00:23.840592 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m11:00:23.841268 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m11:00:23.841858 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m11:00:23.842650 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m11:00:23.843501 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:00:23.844236 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m11:00:23.844860 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:00:23.845394 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:00:23.846093 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m11:00:23.847980 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m11:00:23.849610 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m11:00:23.850670 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m11:00:23.851466 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m11:00:23.852197 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m11:00:23.852740 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m11:00:23.853331 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m11:00:23.853917 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m11:00:23.855662 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m11:00:23.856226 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m11:00:23.856852 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m11:00:23.857743 [info ] [Thread-2 (]: 5 of 29 PASS non_negative_fct_customer_transactions_total_amount_all ........... [[32mPASS[0m in 0.08s]
[0m11:00:23.858462 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m11:00:23.859498 [info ] [Thread-1 (]: 6 of 29 PASS non_negative_fct_customer_transactions_total_amount_completed ..... [[32mPASS[0m in 0.07s]
[0m11:00:23.860200 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m11:00:23.861042 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m11:00:23.861644 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m11:00:23.862447 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m11:00:23.864156 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m11:00:23.864834 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36
[0m11:00:23.865738 [info ] [Thread-3 (]: 7 of 29 PASS non_negative_fct_customer_transactions_transaction_count .......... [[32mPASS[0m in 0.07s]
[0m11:00:23.866438 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m11:00:23.867191 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m11:00:23.867842 [info ] [Thread-2 (]: 9 of 29 START test not_in_future_stg_transactions_transaction_ts ............... [RUN]
[0m11:00:23.868679 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m11:00:23.869302 [info ] [Thread-1 (]: 10 of 29 START test not_null_fct_customer_transactions_customer_id ............. [RUN]
[0m11:00:23.869905 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m11:00:23.870567 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36)
[0m11:00:23.871243 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2
[0m11:00:23.871997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m11:00:23.872831 [info ] [Thread-4 (]: 8 of 29 PASS non_negative_stg_transactions_amount .............................. [[32mPASS[0m in 0.06s]
[0m11:00:23.873497 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36
[0m11:00:23.874120 [info ] [Thread-3 (]: 11 of 29 START test not_null_fct_customer_transactions_first_transaction_ts .... [RUN]
[0m11:00:23.874752 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m11:00:23.875524 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m11:00:23.881146 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"
[0m11:00:23.881796 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2)
[0m11:00:23.889183 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m11:00:23.889920 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a
[0m11:00:23.890849 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2
[0m11:00:23.891748 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36
[0m11:00:23.892452 [info ] [Thread-4 (]: 12 of 29 START test not_null_fct_customer_transactions_last_transaction_ts ..... [RUN]
[0m11:00:23.898253 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m11:00:23.900973 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"
[0m11:00:23.905522 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"
[0m11:00:23.906449 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a)
[0m11:00:23.910260 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m11:00:23.911371 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a
[0m11:00:23.912616 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"
[0m11:00:23.913536 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2
[0m11:00:23.919487 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m11:00:23.921066 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"
[0m11:00:23.921698 [debug] [Thread-2 (]: On test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36: BEGIN
[0m11:00:23.924960 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"
[0m11:00:23.925605 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m11:00:23.926347 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:23.927009 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a
[0m11:00:23.927752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:23.931233 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"
[0m11:00:23.931882 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"
[0m11:00:23.932675 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m11:00:23.933493 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2: BEGIN
[0m11:00:23.934066 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:00:23.934668 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"
[0m11:00:23.935283 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"
[0m11:00:23.935887 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:00:23.936495 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m11:00:23.937133 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a: BEGIN
[0m11:00:23.937759 [debug] [Thread-2 (]: On test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts > current_timestamp


  
  
      
    ) dbt_internal_test
[0m11:00:23.938585 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m11:00:23.939222 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m11:00:23.939791 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:00:23.940896 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"
[0m11:00:23.941954 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_transaction_ts
from "medallion"."main"."fct_customer_transactions"
where first_transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m11:00:23.942570 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m11:00:23.943112 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:00:23.943704 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m11:00:23.944357 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"
[0m11:00:23.946206 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m11:00:23.946892 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m11:00:23.947478 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_transaction_ts
from "medallion"."main"."fct_customer_transactions"
where last_transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m11:00:23.948171 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m11:00:23.949853 [debug] [Thread-2 (]: On test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36: ROLLBACK
[0m11:00:23.951531 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2: ROLLBACK
[0m11:00:23.952114 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m11:00:23.952642 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m11:00:23.953329 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36'
[0m11:00:23.954010 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2'
[0m11:00:23.955018 [info ] [Thread-1 (]: 10 of 29 PASS not_null_fct_customer_transactions_customer_id ................... [[32mPASS[0m in 0.08s]
[0m11:00:23.956655 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a: ROLLBACK
[0m11:00:23.957250 [debug] [Thread-2 (]: On test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36: Close
[0m11:00:23.957867 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2: Close
[0m11:00:23.958676 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m11:00:23.959633 [info ] [Thread-2 (]: 9 of 29 PASS not_in_future_stg_transactions_transaction_ts ..................... [[32mPASS[0m in 0.09s]
[0m11:00:23.960366 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a'
[0m11:00:23.961106 [info ] [Thread-3 (]: 11 of 29 PASS not_null_fct_customer_transactions_first_transaction_ts .......... [[32mPASS[0m in 0.08s]
[0m11:00:23.961823 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m11:00:23.962637 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36
[0m11:00:23.963348 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a: Close
[0m11:00:23.964179 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2
[0m11:00:23.964822 [info ] [Thread-1 (]: 13 of 29 START test not_null_fct_customer_transactions_total_amount_all ........ [RUN]
[0m11:00:23.965525 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m11:00:23.966417 [info ] [Thread-4 (]: 12 of 29 PASS not_null_fct_customer_transactions_last_transaction_ts ........... [[32mPASS[0m in 0.06s]
[0m11:00:23.967133 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m11:00:23.967887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m11:00:23.968527 [info ] [Thread-2 (]: 14 of 29 START test not_null_fct_customer_transactions_total_amount_completed .. [RUN]
[0m11:00:23.969375 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a
[0m11:00:23.969987 [info ] [Thread-3 (]: 15 of 29 START test not_null_fct_customer_transactions_transaction_count ....... [RUN]
[0m11:00:23.970634 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m11:00:23.971299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m11:00:23.971929 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m11:00:23.972669 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m11:00:23.977813 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m11:00:23.978570 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m11:00:23.979396 [info ] [Thread-4 (]: 16 of 29 START test not_null_stg_transactions_amount ........................... [RUN]
[0m11:00:23.980415 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m11:00:23.985596 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m11:00:23.986395 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m11:00:23.987316 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m11:00:23.991924 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m11:00:23.995180 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m11:00:23.995847 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m11:00:23.996377 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m11:00:23.997292 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m11:00:24.001610 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m11:00:24.006240 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m11:00:24.006906 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m11:00:24.007585 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m11:00:24.011267 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m11:00:24.011986 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m11:00:24.012596 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m11:00:24.013196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:24.013956 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m11:00:24.014548 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m11:00:24.017496 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m11:00:24.018397 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:24.018995 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m11:00:24.019618 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:00:24.020523 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:00:24.021106 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m11:00:24.021712 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m11:00:24.022382 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m11:00:24.023338 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m11:00:24.023990 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m11:00:24.024619 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m11:00:24.025243 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m11:00:24.025875 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m11:00:24.026496 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m11:00:24.027292 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:00:24.027917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:00:24.028694 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m11:00:24.029532 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:00:24.031357 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m11:00:24.032125 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m11:00:24.032996 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m11:00:24.033625 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m11:00:24.034157 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m11:00:24.034759 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m11:00:24.036363 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m11:00:24.037078 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m11:00:24.038578 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m11:00:24.039430 [info ] [Thread-1 (]: 13 of 29 PASS not_null_fct_customer_transactions_total_amount_all .............. [[32mPASS[0m in 0.07s]
[0m11:00:24.040149 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m11:00:24.041114 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m11:00:24.042204 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m11:00:24.042865 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:00:24.043393 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m11:00:24.043960 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m11:00:24.044649 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m11:00:24.046582 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m11:00:24.047336 [info ] [Thread-2 (]: 14 of 29 PASS not_null_fct_customer_transactions_total_amount_completed ........ [[32mPASS[0m in 0.08s]
[0m11:00:24.048229 [info ] [Thread-3 (]: 15 of 29 PASS not_null_fct_customer_transactions_transaction_count ............. [[32mPASS[0m in 0.08s]
[0m11:00:24.048885 [info ] [Thread-1 (]: 17 of 29 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m11:00:24.049603 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m11:00:24.050357 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m11:00:24.051160 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m11:00:24.051828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m11:00:24.052436 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m11:00:24.053065 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m11:00:24.053701 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m11:00:24.054432 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m11:00:24.055247 [info ] [Thread-4 (]: 16 of 29 PASS not_null_stg_transactions_amount ................................. [[32mPASS[0m in 0.07s]
[0m11:00:24.055890 [info ] [Thread-2 (]: 18 of 29 START test not_null_stg_transactions_status ........................... [RUN]
[0m11:00:24.056559 [info ] [Thread-3 (]: 19 of 29 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m11:00:24.061592 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m11:00:24.062433 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m11:00:24.063085 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m11:00:24.063754 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m11:00:24.064573 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m11:00:24.065208 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m11:00:24.065879 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m11:00:24.066497 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m11:00:24.069605 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m11:00:24.070240 [info ] [Thread-4 (]: 20 of 29 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m11:00:24.076156 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m11:00:24.080711 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m11:00:24.081547 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m11:00:24.082541 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m11:00:24.083118 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m11:00:24.083696 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m11:00:24.084312 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m11:00:24.084930 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m11:00:24.087862 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m11:00:24.090833 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m11:00:24.095429 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m11:00:24.096058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:24.097059 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m11:00:24.097669 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m11:00:24.098678 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m11:00:24.099288 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m11:00:24.099967 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m11:00:24.100538 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:00:24.101094 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:24.104262 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m11:00:24.104943 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:00:24.105603 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m11:00:24.106647 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m11:00:24.107342 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m11:00:24.108177 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m11:00:24.108814 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m11:00:24.109480 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m11:00:24.110136 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m11:00:24.111082 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m11:00:24.112023 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m11:00:24.112701 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:00:24.113451 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:00:24.114326 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m11:00:24.115129 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:00:24.116994 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m11:00:24.118124 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m11:00:24.118915 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:00:24.119644 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m11:00:24.120332 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m11:00:24.121978 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m11:00:24.123624 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m11:00:24.124232 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m11:00:24.124864 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m11:00:24.125540 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m11:00:24.126203 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m11:00:24.127089 [info ] [Thread-1 (]: 17 of 29 PASS not_null_stg_transactions_customer_id ............................ [[32mPASS[0m in 0.08s]
[0m11:00:24.127977 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m11:00:24.128565 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m11:00:24.129164 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m11:00:24.129974 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m11:00:24.130816 [info ] [Thread-2 (]: 18 of 29 PASS not_null_stg_transactions_status ................................. [[32mPASS[0m in 0.07s]
[0m11:00:24.131671 [info ] [Thread-3 (]: 19 of 29 PASS not_null_stg_transactions_transaction_date ....................... [[32mPASS[0m in 0.07s]
[0m11:00:24.133421 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m11:00:24.134088 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m11:00:24.134892 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m11:00:24.135832 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m11:00:24.136495 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m11:00:24.137145 [info ] [Thread-1 (]: 21 of 29 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m11:00:24.137874 [debug] [Thread-2 (]: Began running node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9
[0m11:00:24.138600 [debug] [Thread-3 (]: Began running node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4
[0m11:00:24.139290 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m11:00:24.139944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m11:00:24.140538 [info ] [Thread-2 (]: 22 of 29 START test total_amount_non_negative_fct_customer_transactions_total_amount_all  [RUN]
[0m11:00:24.141213 [info ] [Thread-3 (]: 23 of 29 START test total_amount_non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m11:00:24.142066 [info ] [Thread-4 (]: 20 of 29 PASS not_null_stg_transactions_transaction_id ......................... [[32mPASS[0m in 0.06s]
[0m11:00:24.142737 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m11:00:24.143343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9)
[0m11:00:24.144042 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c, now test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4)
[0m11:00:24.144854 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m11:00:24.149795 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m11:00:24.150442 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9
[0m11:00:24.151051 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4
[0m11:00:24.151682 [debug] [Thread-4 (]: Began running node test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262
[0m11:00:24.159175 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"
[0m11:00:24.159857 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m11:00:24.164511 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"
[0m11:00:24.165186 [info ] [Thread-4 (]: 24 of 29 START test transaction_count_positive_fct_customer_transactions_transaction_count  [RUN]
[0m11:00:24.168476 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m11:00:24.169061 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9
[0m11:00:24.169863 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4, now test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262)
[0m11:00:24.173196 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"
[0m11:00:24.173858 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4
[0m11:00:24.174496 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262
[0m11:00:24.175366 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m11:00:24.176103 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"
[0m11:00:24.179086 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"
[0m11:00:24.185119 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"
[0m11:00:24.185786 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m11:00:24.186478 [debug] [Thread-2 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9: BEGIN
[0m11:00:24.187456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:24.188075 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262
[0m11:00:24.188764 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:24.189435 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"
[0m11:00:24.193033 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"
[0m11:00:24.193757 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:00:24.194676 [debug] [Thread-3 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4: BEGIN
[0m11:00:24.195383 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m11:00:24.196277 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m11:00:24.197052 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:00:24.197683 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"
[0m11:00:24.198337 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"
[0m11:00:24.199033 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m11:00:24.199892 [debug] [Thread-4 (]: On test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262: BEGIN
[0m11:00:24.200531 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m11:00:24.201225 [debug] [Thread-2 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0


  
  
      
    ) dbt_internal_test
[0m11:00:24.202174 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:00:24.202807 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"
[0m11:00:24.203923 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:00:24.204648 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:00:24.205247 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m11:00:24.205900 [debug] [Thread-3 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0


  
  
      
    ) dbt_internal_test
[0m11:00:24.206696 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"
[0m11:00:24.209777 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m11:00:24.210842 [debug] [Thread-4 (]: On test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count <= 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m11:00:24.212600 [debug] [Thread-2 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9: ROLLBACK
[0m11:00:24.213298 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m11:00:24.214135 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:00:24.214925 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m11:00:24.215500 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:00:24.216221 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9'
[0m11:00:24.217834 [debug] [Thread-3 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4: ROLLBACK
[0m11:00:24.218644 [info ] [Thread-1 (]: 21 of 29 PASS not_null_stg_transactions_transaction_ts ......................... [[32mPASS[0m in 0.08s]
[0m11:00:24.219439 [debug] [Thread-2 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9: Close
[0m11:00:24.221015 [debug] [Thread-4 (]: On test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262: ROLLBACK
[0m11:00:24.221667 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4'
[0m11:00:24.222481 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m11:00:24.223337 [info ] [Thread-2 (]: 22 of 29 PASS total_amount_non_negative_fct_customer_transactions_total_amount_all  [[32mPASS[0m in 0.08s]
[0m11:00:24.224070 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262'
[0m11:00:24.224633 [debug] [Thread-3 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4: Close
[0m11:00:24.225292 [debug] [Thread-1 (]: Began running node test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e
[0m11:00:24.226122 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9
[0m11:00:24.226790 [debug] [Thread-4 (]: On test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262: Close
[0m11:00:24.227622 [info ] [Thread-3 (]: 23 of 29 PASS total_amount_non_negative_fct_customer_transactions_total_amount_completed  [[32mPASS[0m in 0.08s]
[0m11:00:24.228255 [info ] [Thread-1 (]: 25 of 29 START test unique_customer_rows_fct_customer_transactions_ ............ [RUN]
[0m11:00:24.228935 [debug] [Thread-2 (]: Began running node test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40
[0m11:00:24.229756 [info ] [Thread-4 (]: 24 of 29 PASS transaction_count_positive_fct_customer_transactions_transaction_count  [[32mPASS[0m in 0.06s]
[0m11:00:24.230572 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4
[0m11:00:24.231166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7, now test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e)
[0m11:00:24.231806 [info ] [Thread-2 (]: 26 of 29 START test unique_fct_customer_transactions_customer_id ............... [RUN]
[0m11:00:24.232703 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262
[0m11:00:24.233482 [debug] [Thread-3 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m11:00:24.234065 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e
[0m11:00:24.234859 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9, now test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40)
[0m11:00:24.235487 [debug] [Thread-4 (]: Began running node test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc
[0m11:00:24.236159 [info ] [Thread-3 (]: 27 of 29 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m11:00:24.241688 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"
[0m11:00:24.242359 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40
[0m11:00:24.243101 [info ] [Thread-4 (]: 28 of 29 START test unique_transaction_id_stg_transactions_transaction_id ...... [RUN]
[0m11:00:24.243850 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m11:00:24.251390 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"
[0m11:00:24.252132 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262, now test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc)
[0m11:00:24.252752 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m11:00:24.253341 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e
[0m11:00:24.254072 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc
[0m11:00:24.254706 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40
[0m11:00:24.259275 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m11:00:24.262342 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"
[0m11:00:24.267648 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"
[0m11:00:24.270513 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"
[0m11:00:24.271535 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"
[0m11:00:24.272109 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m11:00:24.272920 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc
[0m11:00:24.273588 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"
[0m11:00:24.274161 [debug] [Thread-1 (]: On test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e: BEGIN
[0m11:00:24.278269 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m11:00:24.343975 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"
[0m11:00:24.344931 [debug] [Thread-2 (]: On test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40: BEGIN
[0m11:00:24.345799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:24.347357 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m11:00:24.348186 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:24.349003 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"
[0m11:00:24.350171 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m11:00:24.351224 [debug] [Thread-4 (]: On test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc: BEGIN
[0m11:00:24.351983 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:00:24.352764 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m11:00:24.353545 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:00:24.354218 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:00:24.354939 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"
[0m11:00:24.355689 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"
[0m11:00:24.356808 [debug] [Thread-1 (]: On test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select customer_id
from "medallion"."main"."fct_customer_transactions"
group by customer_id
having count(*) > 1


  
  
      
    ) dbt_internal_test
[0m11:00:24.357551 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:00:24.358232 [debug] [Thread-2 (]: On test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "medallion"."main"."fct_customer_transactions"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:00:24.358893 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m11:00:24.359822 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m11:00:24.360835 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:00:24.361731 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"
[0m11:00:24.362384 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m11:00:24.362985 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:00:24.364949 [debug] [Thread-1 (]: On test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e: ROLLBACK
[0m11:00:24.365569 [debug] [Thread-4 (]: On test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select transaction_id
from "medallion"."main"."stg_transactions"
group by transaction_id
having count(*) > 1


  
  
      
    ) dbt_internal_test
[0m11:00:24.367493 [debug] [Thread-2 (]: On test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40: ROLLBACK
[0m11:00:24.368183 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e'
[0m11:00:24.369094 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40'
[0m11:00:24.369748 [debug] [Thread-1 (]: On test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e: Close
[0m11:00:24.370365 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:00:24.370940 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:00:24.371479 [debug] [Thread-2 (]: On test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40: Close
[0m11:00:24.372449 [info ] [Thread-1 (]: 25 of 29 PASS unique_customer_rows_fct_customer_transactions_ .................. [[32mPASS[0m in 0.14s]
[0m11:00:24.374539 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m11:00:24.375461 [info ] [Thread-2 (]: 26 of 29 PASS unique_fct_customer_transactions_customer_id ..................... [[32mPASS[0m in 0.14s]
[0m11:00:24.376477 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e
[0m11:00:24.378152 [debug] [Thread-4 (]: On test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc: ROLLBACK
[0m11:00:24.378878 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m11:00:24.379640 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40
[0m11:00:24.380331 [debug] [Thread-1 (]: Began running node test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518
[0m11:00:24.380980 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc'
[0m11:00:24.381618 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m11:00:24.382559 [info ] [Thread-1 (]: 29 of 29 START test valid_timestamp_stg_transactions_transaction_ts ............ [RUN]
[0m11:00:24.383196 [debug] [Thread-4 (]: On test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc: Close
[0m11:00:24.384145 [info ] [Thread-3 (]: 27 of 29 PASS unique_stg_transactions_transaction_id ........................... [[32mPASS[0m in 0.14s]
[0m11:00:24.384843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e, now test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518)
[0m11:00:24.385643 [info ] [Thread-4 (]: 28 of 29 PASS unique_transaction_id_stg_transactions_transaction_id ............ [[32mPASS[0m in 0.13s]
[0m11:00:24.386536 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m11:00:24.387179 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518
[0m11:00:24.387970 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc
[0m11:00:24.394119 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"
[0m11:00:24.395091 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518
[0m11:00:24.398744 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"
[0m11:00:24.399871 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"
[0m11:00:24.400538 [debug] [Thread-1 (]: On test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518: BEGIN
[0m11:00:24.401146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:24.402122 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:00:24.402711 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"
[0m11:00:24.403290 [debug] [Thread-1 (]: On test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null


  
  
      
    ) dbt_internal_test
[0m11:00:24.405175 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:00:24.407699 [debug] [Thread-1 (]: On test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518: ROLLBACK
[0m11:00:24.408561 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518'
[0m11:00:24.409252 [debug] [Thread-1 (]: On test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518: Close
[0m11:00:24.410264 [info ] [Thread-1 (]: 29 of 29 PASS valid_timestamp_stg_transactions_transaction_ts .................. [[32mPASS[0m in 0.03s]
[0m11:00:24.411182 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518
[0m11:00:24.412878 [debug] [MainThread]: Using duckdb connection "master"
[0m11:00:24.413425 [debug] [MainThread]: On master: BEGIN
[0m11:00:24.413942 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:00:24.414788 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:00:24.415285 [debug] [MainThread]: On master: COMMIT
[0m11:00:24.415780 [debug] [MainThread]: Using duckdb connection "master"
[0m11:00:24.416254 [debug] [MainThread]: On master: COMMIT
[0m11:00:24.416920 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:00:24.417424 [debug] [MainThread]: On master: Close
[0m11:00:24.418043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:24.418509 [debug] [MainThread]: Connection 'test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518' was properly closed.
[0m11:00:24.418984 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40' was properly closed.
[0m11:00:24.419441 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m11:00:24.419904 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc' was properly closed.
[0m11:00:24.420458 [info ] [MainThread]: 
[0m11:00:24.420985 [info ] [MainThread]: Finished running 29 data tests in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m11:00:24.426601 [debug] [MainThread]: Command end result
[0m11:00:24.458653 [debug] [MainThread]: Wrote artifact WritableManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/manifest.json
[0m11:00:24.461029 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/semantic_manifest.json
[0m11:00:24.471707 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/run_results.json
[0m11:00:24.472284 [info ] [MainThread]: 
[0m11:00:24.472879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:00:24.473398 [info ] [MainThread]: 
[0m11:00:24.473930 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=29
[0m11:00:24.475045 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.8587962, "process_in_blocks": "0", "process_kernel_time": 0.153873, "process_mem_max_rss": "160484", "process_out_blocks": "2944", "process_user_time": 3.212352}
[0m11:00:24.475660 [debug] [MainThread]: Command `dbt test` succeeded at 11:00:24.475543 after 1.86 seconds
[0m11:00:24.476219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fe7cac0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fe6bb8640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fe6bb9600>]}
[0m11:00:24.476775 [debug] [MainThread]: Flushing usage events
[0m11:00:25.306577 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:02:08.478501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730643974160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730643828d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730642a57670>]}


============================== 11:02:08.481552 | 373aa8b0-015c-45ea-a8c0-e0081c58a517 ==============================
[0m11:02:08.481552 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:02:08.482244 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'profiles_dir': '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/profiles', 'target_path': 'None', 'fail_fast': 'False', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_path': '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/logs', 'static_parser': 'True', 'use_experimental_parser': 'False', 'no_print': 'None'}
[0m11:02:08.820017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '373aa8b0-015c-45ea-a8c0-e0081c58a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730645351f60>]}
[0m11:02:08.924176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '373aa8b0-015c-45ea-a8c0-e0081c58a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306428ee770>]}
[0m11:02:08.926291 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:02:09.043248 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:02:09.222679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:02:09.223348 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:02:09.286460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '373aa8b0-015c-45ea-a8c0-e0081c58a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730639940130>]}
[0m11:02:09.473464 [debug] [MainThread]: Wrote artifact WritableManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/manifest.json
[0m11:02:09.475484 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/semantic_manifest.json
[0m11:02:09.490221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '373aa8b0-015c-45ea-a8c0-e0081c58a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730639943cd0>]}
[0m11:02:09.490969 [info ] [MainThread]: Found 2 models, 29 data tests, 454 macros
[0m11:02:09.491488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '373aa8b0-015c-45ea-a8c0-e0081c58a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730639943ca0>]}
[0m11:02:09.493814 [info ] [MainThread]: 
[0m11:02:09.494371 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:02:09.494868 [info ] [MainThread]: 
[0m11:02:09.495570 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:02:09.502390 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m11:02:09.542886 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m11:02:09.543486 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m11:02:09.543980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:09.558186 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m11:02:09.559804 [debug] [ThreadPool]: On list_medallion: Close
[0m11:02:09.560706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m11:02:09.561371 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m11:02:09.569869 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:02:09.570603 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m11:02:09.571210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:09.572547 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:02:09.574173 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:02:09.574680 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m11:02:09.575380 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:02:09.575861 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:02:09.576331 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m11:02:09.577043 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:02:09.578057 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m11:02:09.578553 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m11:02:09.579034 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m11:02:09.579675 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:02:09.580178 [debug] [ThreadPool]: On create_medallion_main: Close
[0m11:02:09.581545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m11:02:09.588578 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m11:02:09.589416 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m11:02:09.590104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:09.591021 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:02:09.591503 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m11:02:09.591999 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m11:02:09.604761 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m11:02:09.606944 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m11:02:09.607698 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m11:02:09.608211 [debug] [ThreadPool]: On list_medallion_main: Close
[0m11:02:09.609511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '373aa8b0-015c-45ea-a8c0-e0081c58a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306432f3880>]}
[0m11:02:09.610169 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:09.610652 [debug] [MainThread]: On master: BEGIN
[0m11:02:09.611128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:09.611975 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:02:09.612460 [debug] [MainThread]: On master: COMMIT
[0m11:02:09.612953 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:09.613425 [debug] [MainThread]: On master: COMMIT
[0m11:02:09.614080 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:02:09.614581 [debug] [MainThread]: On master: Close
[0m11:02:09.617497 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m11:02:09.618258 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m11:02:09.618962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m11:02:09.619810 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m11:02:09.633455 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m11:02:09.634323 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m11:02:09.675096 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m11:02:09.675993 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:02:09.676558 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m11:02:09.677096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:09.678091 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:02:09.678656 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:02:09.679236 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/data/clean/transactions_20251201_clean.parquet'
    )
)

-- queries
select
    cast(transaction_id as integer) as transaction_id,
    cast(customer_id as integer) as customer_id,
    cast(amount as decimal(10, 2)) as amount,
    cast(status as varchar) as status,
    cast(transaction_ts as timestamp) as transaction_ts,
    cast(transaction_date as date) as transaction_date
from source
  );

[0m11:02:09.680619 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:02:09.689810 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:02:09.690480 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m11:02:09.691479 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:02:09.696235 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:02:09.696816 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m11:02:09.697689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:02:09.713255 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m11:02:09.713919 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:02:09.714459 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m11:02:09.726775 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m11:02:09.733677 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m11:02:09.734280 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m11:02:09.752021 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m11:02:09.756043 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m11:02:09.758369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '373aa8b0-015c-45ea-a8c0-e0081c58a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306453a62c0>]}
[0m11:02:09.759272 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.14s]
[0m11:02:09.760108 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m11:02:09.761059 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m11:02:09.761781 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m11:02:09.762545 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m11:02:09.763129 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m11:02:09.767076 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m11:02:09.768059 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m11:02:09.806222 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m11:02:09.807668 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:02:09.808663 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m11:02:09.809593 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:02:09.811090 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:02:09.812032 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:02:09.813016 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select * from "medallion"."main"."stg_transactions"
)

-- queries

select
    customer_id,
    count(*) as transaction_count,
    sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
    sum(amount) as total_amount_all,
    min(transaction_ts) as first_transaction_ts,   
    max(transaction_ts) as last_transaction_ts     
from "medallion"."main"."stg_transactions"
group by customer_id
    );
  
  
[0m11:02:09.817204 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m11:02:09.826127 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:02:09.827223 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_customer_transactions'
  
[0m11:02:09.829188 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:02:09.831043 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:02:09.831709 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_customer_transactions'
  
[0m11:02:09.833200 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:02:09.838749 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:02:09.839640 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions" rename to "fct_customer_transactions__dbt_backup"
[0m11:02:09.841230 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:02:09.848032 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:02:09.848802 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions__dbt_tmp" rename to "fct_customer_transactions"
[0m11:02:09.849968 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:02:09.857490 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m11:02:09.858293 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:02:09.858968 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m11:02:09.869334 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m11:02:09.874055 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m11:02:09.874774 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

      drop table if exists "medallion"."main"."fct_customer_transactions__dbt_backup" cascade
    
[0m11:02:09.881871 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m11:02:09.884249 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m11:02:09.885170 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '373aa8b0-015c-45ea-a8c0-e0081c58a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730638197910>]}
[0m11:02:09.886323 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.fct_customer_transactions ............... [[32mOK[0m in 0.12s]
[0m11:02:09.887539 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m11:02:09.889266 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:09.890256 [debug] [MainThread]: On master: BEGIN
[0m11:02:09.890878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:09.891784 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:02:09.892302 [debug] [MainThread]: On master: COMMIT
[0m11:02:09.892818 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:09.893318 [debug] [MainThread]: On master: COMMIT
[0m11:02:09.894169 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:02:09.894701 [debug] [MainThread]: On master: Close
[0m11:02:09.895368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:09.895860 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m11:02:09.896327 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m11:02:09.896853 [info ] [MainThread]: 
[0m11:02:09.897392 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:02:09.898527 [debug] [MainThread]: Command end result
[0m11:02:09.932370 [debug] [MainThread]: Wrote artifact WritableManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/manifest.json
[0m11:02:09.934284 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/semantic_manifest.json
[0m11:02:09.943528 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/run_results.json
[0m11:02:09.944089 [info ] [MainThread]: 
[0m11:02:09.944687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:02:09.945201 [info ] [MainThread]: 
[0m11:02:09.945743 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m11:02:09.946757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.545116, "process_in_blocks": "0", "process_kernel_time": 0.132714, "process_mem_max_rss": "154152", "process_out_blocks": "2352", "process_user_time": 2.980578}
[0m11:02:09.947391 [debug] [MainThread]: Command `dbt run` succeeded at 11:02:09.947265 after 1.55 seconds
[0m11:02:09.947942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730643974160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306439ce9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730642836cb0>]}
[0m11:02:09.948500 [debug] [MainThread]: Flushing usage events
[0m11:02:10.775046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:02:13.997606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ef4c2ac160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ef4c15cd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ef4ba67a00>]}


============================== 11:02:14.000634 | 68389e50-ea27-42fe-82ff-2a42c35acf6b ==============================
[0m11:02:14.000634 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:02:14.001328 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'profiles_dir': '/home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/profiles', 'partial_parse': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt', 'empty': 'None', 'debug': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'printer_width': '80', 'target_path': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'version_check': 'True'}
[0m11:02:14.289049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68389e50-ea27-42fe-82ff-2a42c35acf6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ef4d952a40>]}
[0m11:02:14.372449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68389e50-ea27-42fe-82ff-2a42c35acf6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ef46fa2320>]}
[0m11:02:14.374650 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:02:14.488106 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:02:14.663919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:02:14.664468 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:02:14.727611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68389e50-ea27-42fe-82ff-2a42c35acf6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ef42268100>]}
[0m11:02:14.914835 [debug] [MainThread]: Wrote artifact WritableManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/manifest.json
[0m11:02:14.916900 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/semantic_manifest.json
[0m11:02:14.942092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68389e50-ea27-42fe-82ff-2a42c35acf6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ef434b61a0>]}
[0m11:02:14.942847 [info ] [MainThread]: Found 2 models, 29 data tests, 454 macros
[0m11:02:14.943380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68389e50-ea27-42fe-82ff-2a42c35acf6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ef4d0891b0>]}
[0m11:02:14.946974 [info ] [MainThread]: 
[0m11:02:14.947590 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:02:14.948130 [info ] [MainThread]: 
[0m11:02:14.948860 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:02:14.956206 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m11:02:14.997703 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m11:02:14.998324 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m11:02:14.998846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:15.012614 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m11:02:15.013239 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m11:02:15.013778 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m11:02:15.026929 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:02:15.028651 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m11:02:15.029428 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m11:02:15.029929 [debug] [ThreadPool]: On list_medallion_main: Close
[0m11:02:15.031281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68389e50-ea27-42fe-82ff-2a42c35acf6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ef4237e950>]}
[0m11:02:15.032184 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:15.032699 [debug] [MainThread]: On master: BEGIN
[0m11:02:15.033195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:15.034058 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:02:15.034554 [debug] [MainThread]: On master: COMMIT
[0m11:02:15.035043 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:15.035518 [debug] [MainThread]: On master: COMMIT
[0m11:02:15.036388 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:02:15.036946 [debug] [MainThread]: On master: Close
[0m11:02:15.040486 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9
[0m11:02:15.041280 [debug] [Thread-2 (]: Began running node test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609
[0m11:02:15.042151 [info ] [Thread-1 (]: 1 of 29 START test accepted_status_stg_transactions_status ..................... [RUN]
[0m11:02:15.042844 [debug] [Thread-3 (]: Began running node test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316
[0m11:02:15.043432 [info ] [Thread-2 (]: 2 of 29 START test amount_not_outlier_stg_transactions_amount .................. [RUN]
[0m11:02:15.044131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9)
[0m11:02:15.044875 [debug] [Thread-4 (]: Began running node test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de
[0m11:02:15.045483 [info ] [Thread-3 (]: 3 of 29 START test customer_exists_in_silver_fct_customer_transactions_customer_id  [RUN]
[0m11:02:15.046264 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609'
[0m11:02:15.046838 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9
[0m11:02:15.047453 [info ] [Thread-4 (]: 4 of 29 START test no_duplicate_rows_stg_transactions_ ......................... [RUN]
[0m11:02:15.048227 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316'
[0m11:02:15.048846 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609
[0m11:02:15.066238 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"
[0m11:02:15.067016 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de'
[0m11:02:15.067647 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316
[0m11:02:15.075424 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"
[0m11:02:15.076346 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de
[0m11:02:15.077008 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9
[0m11:02:15.083841 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"
[0m11:02:15.090199 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"
[0m11:02:15.090905 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609
[0m11:02:15.114445 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"
[0m11:02:15.115381 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316
[0m11:02:15.116025 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de
[0m11:02:15.119262 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"
[0m11:02:15.123305 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"
[0m11:02:15.126659 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"
[0m11:02:15.127350 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"
[0m11:02:15.128296 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"
[0m11:02:15.129156 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"
[0m11:02:15.129776 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"
[0m11:02:15.130368 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9: BEGIN
[0m11:02:15.130952 [debug] [Thread-2 (]: On test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609: BEGIN
[0m11:02:15.131538 [debug] [Thread-3 (]: On test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316: BEGIN
[0m11:02:15.132168 [debug] [Thread-4 (]: On test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de: BEGIN
[0m11:02:15.132790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:15.133429 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:02:15.134034 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:02:15.134645 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:02:15.136222 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:02:15.137321 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m11:02:15.138302 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"
[0m11:02:15.138896 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m11:02:15.139449 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m11:02:15.140104 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"
[0m11:02:15.140758 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select status
from "medallion"."main"."stg_transactions"
where status not in ('completed', 'pending', 'failed')


  
  
      
    ) dbt_internal_test
[0m11:02:15.141362 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"
[0m11:02:15.141964 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"
[0m11:02:15.142604 [debug] [Thread-3 (]: On test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with silver as (
    select distinct customer_id
    from "medallion"."main"."stg_transactions"
)
select g.customer_id
from "medallion"."main"."fct_customer_transactions" g
left join silver s
    on g.customer_id = s.customer_id
where s.customer_id is null


  
  
      
    ) dbt_internal_test
[0m11:02:15.143486 [debug] [Thread-4 (]: On test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select *
from "medallion"."main"."stg_transactions"
group by *
having count(*) > 1


  
  
      
    ) dbt_internal_test
[0m11:02:15.144191 [debug] [Thread-2 (]: On test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select amount
from "medallion"."main"."stg_transactions"
where amount > 100000


  
  
      
    ) dbt_internal_test
[0m11:02:15.145060 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:02:15.151128 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9: ROLLBACK
[0m11:02:15.151822 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m11:02:15.152475 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m11:02:15.153332 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9'
[0m11:02:15.153986 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m11:02:15.156057 [debug] [Thread-2 (]: On test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609: ROLLBACK
[0m11:02:15.156838 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9: Close
[0m11:02:15.158502 [debug] [Thread-3 (]: On test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316: ROLLBACK
[0m11:02:15.159238 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609'
[0m11:02:15.160853 [debug] [Thread-4 (]: On test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de: ROLLBACK
[0m11:02:15.161499 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316'
[0m11:02:15.162374 [info ] [Thread-1 (]: 1 of 29 PASS accepted_status_stg_transactions_status ........................... [[32mPASS[0m in 0.12s]
[0m11:02:15.162960 [debug] [Thread-2 (]: On test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609: Close
[0m11:02:15.163615 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de'
[0m11:02:15.164250 [debug] [Thread-3 (]: On test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316: Close
[0m11:02:15.165082 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9
[0m11:02:15.165870 [info ] [Thread-2 (]: 2 of 29 PASS amount_not_outlier_stg_transactions_amount ........................ [[32mPASS[0m in 0.12s]
[0m11:02:15.166551 [debug] [Thread-4 (]: On test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de: Close
[0m11:02:15.167393 [info ] [Thread-3 (]: 3 of 29 PASS customer_exists_in_silver_fct_customer_transactions_customer_id ... [[32mPASS[0m in 0.12s]
[0m11:02:15.168107 [debug] [Thread-1 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m11:02:15.168962 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609
[0m11:02:15.170111 [info ] [Thread-4 (]: 4 of 29 PASS no_duplicate_rows_stg_transactions_ ............................... [[32mPASS[0m in 0.10s]
[0m11:02:15.171340 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316
[0m11:02:15.172062 [info ] [Thread-1 (]: 5 of 29 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m11:02:15.172802 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m11:02:15.173788 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de
[0m11:02:15.174483 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m11:02:15.175301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_status_stg_transactions_status.1a74a82ca9, now test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89)
[0m11:02:15.175952 [info ] [Thread-2 (]: 6 of 29 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m11:02:15.176655 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m11:02:15.177312 [info ] [Thread-3 (]: 7 of 29 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m11:02:15.177945 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m11:02:15.178589 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.amount_not_outlier_stg_transactions_amount.fd8578a609, now test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428)
[0m11:02:15.179243 [info ] [Thread-4 (]: 8 of 29 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m11:02:15.179904 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.customer_exists_in_silver_fct_customer_transactions_customer_id.51e5d6c316, now test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4)
[0m11:02:15.187614 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m11:02:15.188475 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m11:02:15.189267 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.no_duplicate_rows_stg_transactions_.1d083bd4de, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m11:02:15.189970 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m11:02:15.195045 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m11:02:15.195693 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m11:02:15.196342 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m11:02:15.200798 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m11:02:15.204757 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m11:02:15.205626 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m11:02:15.210515 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m11:02:15.213904 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m11:02:15.214561 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m11:02:15.215378 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m11:02:15.218940 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m11:02:15.219921 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m11:02:15.220835 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m11:02:15.221854 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m11:02:15.222586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:15.223349 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m11:02:15.224077 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m11:02:15.228327 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m11:02:15.229278 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:02:15.229955 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m11:02:15.230536 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:02:15.231479 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:02:15.232089 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m11:02:15.232768 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m11:02:15.233376 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m11:02:15.234174 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m11:02:15.234921 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m11:02:15.235531 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:02:15.236283 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m11:02:15.237124 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m11:02:15.238370 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m11:02:15.239104 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:02:15.239771 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:02:15.240687 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m11:02:15.242562 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m11:02:15.243319 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m11:02:15.244085 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m11:02:15.244785 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:02:15.245343 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m11:02:15.246045 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m11:02:15.247688 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m11:02:15.249484 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m11:02:15.250042 [debug] [Thread-1 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m11:02:15.250686 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m11:02:15.251476 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m11:02:15.252148 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m11:02:15.253262 [info ] [Thread-1 (]: 5 of 29 PASS non_negative_fct_customer_transactions_total_amount_all ........... [[32mPASS[0m in 0.08s]
[0m11:02:15.254255 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m11:02:15.254970 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m11:02:15.255894 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m11:02:15.256715 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m11:02:15.257571 [info ] [Thread-3 (]: 7 of 29 PASS non_negative_fct_customer_transactions_transaction_count .......... [[32mPASS[0m in 0.08s]
[0m11:02:15.258369 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36
[0m11:02:15.259126 [info ] [Thread-2 (]: 6 of 29 PASS non_negative_fct_customer_transactions_total_amount_completed ..... [[32mPASS[0m in 0.08s]
[0m11:02:15.260974 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m11:02:15.261716 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m11:02:15.262317 [info ] [Thread-1 (]: 9 of 29 START test not_in_future_stg_transactions_transaction_ts ............... [RUN]
[0m11:02:15.263201 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m11:02:15.263868 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m11:02:15.264609 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m11:02:15.265565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36)
[0m11:02:15.266380 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2
[0m11:02:15.267031 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m11:02:15.267754 [info ] [Thread-3 (]: 10 of 29 START test not_null_fct_customer_transactions_customer_id ............. [RUN]
[0m11:02:15.268710 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36
[0m11:02:15.269410 [info ] [Thread-2 (]: 11 of 29 START test not_null_fct_customer_transactions_first_transaction_ts .... [RUN]
[0m11:02:15.270604 [info ] [Thread-4 (]: 8 of 29 PASS non_negative_stg_transactions_amount .............................. [[32mPASS[0m in 0.08s]
[0m11:02:15.271366 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m11:02:15.278157 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"
[0m11:02:15.278950 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2)
[0m11:02:15.279811 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m11:02:15.280438 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m11:02:15.281177 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2
[0m11:02:15.281873 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36
[0m11:02:15.282460 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a
[0m11:02:15.296425 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m11:02:15.297914 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"
[0m11:02:15.301048 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"
[0m11:02:15.301707 [info ] [Thread-4 (]: 12 of 29 START test not_null_fct_customer_transactions_last_transaction_ts ..... [RUN]
[0m11:02:15.302825 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m11:02:15.303783 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2
[0m11:02:15.304833 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a)
[0m11:02:15.308228 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m11:02:15.308961 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"
[0m11:02:15.312066 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"
[0m11:02:15.312713 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a
[0m11:02:15.313456 [debug] [Thread-1 (]: On test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36: BEGIN
[0m11:02:15.314129 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m11:02:15.320494 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"
[0m11:02:15.321428 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"
[0m11:02:15.322049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:15.322710 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m11:02:15.323597 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2: BEGIN
[0m11:02:15.324530 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a
[0m11:02:15.325155 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:02:15.325795 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:02:15.326381 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:02:15.329656 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"
[0m11:02:15.330498 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"
[0m11:02:15.331137 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m11:02:15.332038 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m11:02:15.332677 [debug] [Thread-1 (]: On test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts > current_timestamp


  
  
      
    ) dbt_internal_test
[0m11:02:15.333393 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"
[0m11:02:15.333926 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m11:02:15.334575 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"
[0m11:02:15.335438 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a: BEGIN
[0m11:02:15.336219 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m11:02:15.337236 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:02:15.337989 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_transaction_ts
from "medallion"."main"."fct_customer_transactions"
where first_transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m11:02:15.338617 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:02:15.341248 [debug] [Thread-1 (]: On test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36: ROLLBACK
[0m11:02:15.341939 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m11:02:15.342492 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m11:02:15.343035 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m11:02:15.343767 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36'
[0m11:02:15.345442 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2: ROLLBACK
[0m11:02:15.346171 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"
[0m11:02:15.347741 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m11:02:15.348297 [debug] [Thread-1 (]: On test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36: Close
[0m11:02:15.348985 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2'
[0m11:02:15.349619 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_transaction_ts
from "medallion"."main"."fct_customer_transactions"
where last_transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m11:02:15.350318 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m11:02:15.351155 [info ] [Thread-1 (]: 9 of 29 PASS not_in_future_stg_transactions_transaction_ts ..................... [[32mPASS[0m in 0.09s]
[0m11:02:15.351867 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2: Close
[0m11:02:15.352854 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m11:02:15.354268 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36
[0m11:02:15.355233 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m11:02:15.356282 [info ] [Thread-2 (]: 11 of 29 PASS not_null_fct_customer_transactions_first_transaction_ts .......... [[32mPASS[0m in 0.08s]
[0m11:02:15.357377 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m11:02:15.358557 [info ] [Thread-3 (]: 10 of 29 PASS not_null_fct_customer_transactions_customer_id ................... [[32mPASS[0m in 0.09s]
[0m11:02:15.359775 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2
[0m11:02:15.362237 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a: ROLLBACK
[0m11:02:15.363277 [info ] [Thread-1 (]: 13 of 29 START test not_null_fct_customer_transactions_total_amount_all ........ [RUN]
[0m11:02:15.364261 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m11:02:15.365026 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m11:02:15.365991 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a'
[0m11:02:15.366962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_in_future_stg_transactions_transaction_ts.9882fdcb36, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m11:02:15.367665 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m11:02:15.368364 [info ] [Thread-2 (]: 14 of 29 START test not_null_fct_customer_transactions_total_amount_completed .. [RUN]
[0m11:02:15.369042 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a: Close
[0m11:02:15.369751 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m11:02:15.370540 [info ] [Thread-3 (]: 15 of 29 START test not_null_fct_customer_transactions_transaction_count ....... [RUN]
[0m11:02:15.371321 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_first_transaction_ts.feeab48ec2, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m11:02:15.376393 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m11:02:15.377268 [info ] [Thread-4 (]: 12 of 29 PASS not_null_fct_customer_transactions_last_transaction_ts ........... [[32mPASS[0m in 0.07s]
[0m11:02:15.377960 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m11:02:15.378548 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m11:02:15.379478 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m11:02:15.380303 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a
[0m11:02:15.380928 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m11:02:15.385684 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m11:02:15.389511 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m11:02:15.390317 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m11:02:15.395189 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m11:02:15.396280 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m11:02:15.397140 [info ] [Thread-4 (]: 16 of 29 START test not_null_stg_transactions_amount ........................... [RUN]
[0m11:02:15.397877 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m11:02:15.402318 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m11:02:15.403268 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_last_transaction_ts.15fde1bc7a, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m11:02:15.404150 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m11:02:15.404920 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m11:02:15.405919 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m11:02:15.406620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:15.407474 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m11:02:15.410608 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m11:02:15.415238 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m11:02:15.416149 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m11:02:15.416763 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m11:02:15.417726 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:02:15.418391 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m11:02:15.419207 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m11:02:15.419998 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m11:02:15.424128 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m11:02:15.424847 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m11:02:15.425472 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m11:02:15.426101 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m11:02:15.427148 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m11:02:15.427686 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m11:02:15.428286 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:02:15.428905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:02:15.429533 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m11:02:15.430139 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m11:02:15.431953 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m11:02:15.432788 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:02:15.433598 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m11:02:15.434456 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:02:15.435034 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m11:02:15.435664 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m11:02:15.436240 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m11:02:15.438553 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m11:02:15.439220 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m11:02:15.439893 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m11:02:15.440848 [info ] [Thread-1 (]: 13 of 29 PASS not_null_fct_customer_transactions_total_amount_all .............. [[32mPASS[0m in 0.07s]
[0m11:02:15.441605 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m11:02:15.442256 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m11:02:15.442867 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m11:02:15.443652 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m11:02:15.444516 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m11:02:15.445406 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m11:02:15.446027 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m11:02:15.446807 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:02:15.447574 [info ] [Thread-2 (]: 14 of 29 PASS not_null_fct_customer_transactions_total_amount_completed ........ [[32mPASS[0m in 0.08s]
[0m11:02:15.448174 [info ] [Thread-1 (]: 17 of 29 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m11:02:15.450056 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m11:02:15.450863 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m11:02:15.452457 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m11:02:15.453511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m11:02:15.454570 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m11:02:15.455384 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m11:02:15.456228 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m11:02:15.456908 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m11:02:15.457488 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m11:02:15.458149 [info ] [Thread-2 (]: 18 of 29 START test not_null_stg_transactions_status ........................... [RUN]
[0m11:02:15.458821 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m11:02:15.463737 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m11:02:15.464624 [info ] [Thread-4 (]: 16 of 29 PASS not_null_stg_transactions_amount ................................. [[32mPASS[0m in 0.06s]
[0m11:02:15.465340 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m11:02:15.466187 [info ] [Thread-3 (]: 15 of 29 PASS not_null_fct_customer_transactions_transaction_count ............. [[32mPASS[0m in 0.09s]
[0m11:02:15.467209 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m11:02:15.467882 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m11:02:15.468506 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m11:02:15.469410 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m11:02:15.470387 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m11:02:15.473964 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m11:02:15.478805 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m11:02:15.479495 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m11:02:15.480216 [info ] [Thread-4 (]: 19 of 29 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m11:02:15.481284 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m11:02:15.481931 [info ] [Thread-3 (]: 20 of 29 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m11:02:15.482670 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m11:02:15.483323 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m11:02:15.483957 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m11:02:15.484641 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m11:02:15.491458 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m11:02:15.492274 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m11:02:15.492928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:15.493551 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m11:02:15.498377 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m11:02:15.499126 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m11:02:15.505100 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m11:02:15.505919 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m11:02:15.506731 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m11:02:15.507920 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m11:02:15.508761 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m11:02:15.509318 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m11:02:15.509856 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:02:15.510519 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m11:02:15.513712 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m11:02:15.516535 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m11:02:15.517814 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m11:02:15.518752 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m11:02:15.519592 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m11:02:15.520553 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:02:15.521414 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m11:02:15.522317 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m11:02:15.522953 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m11:02:15.524966 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m11:02:15.525514 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m11:02:15.526128 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:02:15.527079 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m11:02:15.527687 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:02:15.528319 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m11:02:15.529107 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m11:02:15.529698 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m11:02:15.531657 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m11:02:15.532296 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m11:02:15.532934 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m11:02:15.533770 [info ] [Thread-1 (]: 17 of 29 PASS not_null_stg_transactions_customer_id ............................ [[32mPASS[0m in 0.08s]
[0m11:02:15.534507 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m11:02:15.535142 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m11:02:15.535828 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m11:02:15.536693 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m11:02:15.537460 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m11:02:15.538371 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m11:02:15.539389 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m11:02:15.540493 [info ] [Thread-2 (]: 18 of 29 PASS not_null_stg_transactions_status ................................. [[32mPASS[0m in 0.08s]
[0m11:02:15.541261 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:02:15.541940 [info ] [Thread-1 (]: 21 of 29 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m11:02:15.542777 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m11:02:15.543320 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m11:02:15.544139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m11:02:15.545822 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m11:02:15.546447 [debug] [Thread-2 (]: Began running node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9
[0m11:02:15.548214 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m11:02:15.548815 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m11:02:15.549519 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m11:02:15.550177 [info ] [Thread-2 (]: 22 of 29 START test total_amount_non_negative_fct_customer_transactions_total_amount_all  [RUN]
[0m11:02:15.550884 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m11:02:15.556357 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m11:02:15.557124 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m11:02:15.557831 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9)
[0m11:02:15.558396 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m11:02:15.559347 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m11:02:15.560203 [info ] [Thread-4 (]: 19 of 29 PASS not_null_stg_transactions_transaction_date ....................... [[32mPASS[0m in 0.08s]
[0m11:02:15.560830 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9
[0m11:02:15.561611 [info ] [Thread-3 (]: 20 of 29 PASS not_null_stg_transactions_transaction_id ......................... [[32mPASS[0m in 0.08s]
[0m11:02:15.564825 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m11:02:15.565642 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m11:02:15.573790 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"
[0m11:02:15.574710 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m11:02:15.575634 [debug] [Thread-4 (]: Began running node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4
[0m11:02:15.576266 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m11:02:15.577113 [debug] [Thread-3 (]: Began running node test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262
[0m11:02:15.577774 [info ] [Thread-4 (]: 23 of 29 START test total_amount_non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m11:02:15.578527 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m11:02:15.579169 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9
[0m11:02:15.579829 [info ] [Thread-3 (]: 24 of 29 START test transaction_count_positive_fct_customer_transactions_transaction_count  [RUN]
[0m11:02:15.580554 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c, now test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4)
[0m11:02:15.581173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:15.584443 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"
[0m11:02:15.585132 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4, now test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262)
[0m11:02:15.585822 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4
[0m11:02:15.587318 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:02:15.588097 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262
[0m11:02:15.588853 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"
[0m11:02:15.593768 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"
[0m11:02:15.594445 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m11:02:15.600207 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"
[0m11:02:15.600913 [debug] [Thread-2 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9: BEGIN
[0m11:02:15.601663 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m11:02:15.602410 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4
[0m11:02:15.603422 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:02:15.604263 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262
[0m11:02:15.608561 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"
[0m11:02:15.609602 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:02:15.613086 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"
[0m11:02:15.613766 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m11:02:15.614584 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"
[0m11:02:15.616548 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m11:02:15.617187 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"
[0m11:02:15.617842 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"
[0m11:02:15.618528 [debug] [Thread-4 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4: BEGIN
[0m11:02:15.619268 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m11:02:15.620008 [debug] [Thread-2 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0


  
  
      
    ) dbt_internal_test
[0m11:02:15.620798 [debug] [Thread-3 (]: On test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262: BEGIN
[0m11:02:15.621526 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:02:15.622185 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m11:02:15.623050 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:02:15.623753 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:02:15.624634 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m11:02:15.625624 [info ] [Thread-1 (]: 21 of 29 PASS not_null_stg_transactions_transaction_ts ......................... [[32mPASS[0m in 0.08s]
[0m11:02:15.626389 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"
[0m11:02:15.626983 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:02:15.628707 [debug] [Thread-2 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9: ROLLBACK
[0m11:02:15.629513 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m11:02:15.630114 [debug] [Thread-4 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0


  
  
      
    ) dbt_internal_test
[0m11:02:15.630781 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"
[0m11:02:15.631424 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9'
[0m11:02:15.632096 [debug] [Thread-1 (]: Began running node test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e
[0m11:02:15.632933 [debug] [Thread-3 (]: On test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count <= 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m11:02:15.633568 [debug] [Thread-2 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9: Close
[0m11:02:15.634119 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m11:02:15.634814 [info ] [Thread-1 (]: 25 of 29 START test unique_customer_rows_fct_customer_transactions_ ............ [RUN]
[0m11:02:15.636187 [info ] [Thread-2 (]: 22 of 29 PASS total_amount_non_negative_fct_customer_transactions_total_amount_all  [[32mPASS[0m in 0.08s]
[0m11:02:15.638422 [debug] [Thread-4 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4: ROLLBACK
[0m11:02:15.639191 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:02:15.639985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7, now test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e)
[0m11:02:15.640982 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9
[0m11:02:15.641816 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4'
[0m11:02:15.642406 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e
[0m11:02:15.644081 [debug] [Thread-3 (]: On test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262: ROLLBACK
[0m11:02:15.644762 [debug] [Thread-2 (]: Began running node test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40
[0m11:02:15.645448 [debug] [Thread-4 (]: On test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4: Close
[0m11:02:15.652596 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"
[0m11:02:15.653552 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262'
[0m11:02:15.654374 [info ] [Thread-2 (]: 26 of 29 START test unique_fct_customer_transactions_customer_id ............... [RUN]
[0m11:02:15.655480 [info ] [Thread-4 (]: 23 of 29 PASS total_amount_non_negative_fct_customer_transactions_total_amount_completed  [[32mPASS[0m in 0.07s]
[0m11:02:15.656279 [debug] [Thread-3 (]: On test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262: Close
[0m11:02:15.656992 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e
[0m11:02:15.657608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_all.60996d2cd9, now test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40)
[0m11:02:15.658451 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4
[0m11:02:15.659263 [info ] [Thread-3 (]: 24 of 29 PASS transaction_count_positive_fct_customer_transactions_transaction_count  [[32mPASS[0m in 0.07s]
[0m11:02:15.662318 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"
[0m11:02:15.662896 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40
[0m11:02:15.663546 [debug] [Thread-4 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m11:02:15.664424 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262
[0m11:02:15.672424 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"
[0m11:02:15.673252 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"
[0m11:02:15.673865 [info ] [Thread-4 (]: 27 of 29 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m11:02:15.674555 [debug] [Thread-3 (]: Began running node test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc
[0m11:02:15.675417 [debug] [Thread-1 (]: On test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e: BEGIN
[0m11:02:15.676003 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40
[0m11:02:15.676697 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.total_amount_non_negative_fct_customer_transactions_total_amount_completed.59a06a8ad4, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m11:02:15.677307 [info ] [Thread-3 (]: 28 of 29 START test unique_transaction_id_stg_transactions_transaction_id ...... [RUN]
[0m11:02:15.677918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:15.681118 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"
[0m11:02:15.681741 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m11:02:15.682353 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.transaction_count_positive_fct_customer_transactions_transaction_count.867757d262, now test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc)
[0m11:02:15.688515 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m11:02:15.689337 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m11:02:15.690421 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"
[0m11:02:15.691304 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc
[0m11:02:15.692062 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"
[0m11:02:15.692762 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m11:02:15.693331 [debug] [Thread-2 (]: On test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40: BEGIN
[0m11:02:15.699134 [debug] [Thread-1 (]: On test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select customer_id
from "medallion"."main"."fct_customer_transactions"
group by customer_id
having count(*) > 1


  
  
      
    ) dbt_internal_test
[0m11:02:15.699737 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"
[0m11:02:15.702773 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m11:02:15.703522 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:02:15.705344 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m11:02:15.705998 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc
[0m11:02:15.706728 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m11:02:15.707351 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:02:15.707894 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m11:02:15.712211 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"
[0m11:02:15.712806 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"
[0m11:02:15.713562 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:02:15.715233 [debug] [Thread-1 (]: On test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e: ROLLBACK
[0m11:02:15.716124 [debug] [Thread-2 (]: On test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "medallion"."main"."fct_customer_transactions"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:02:15.716769 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"
[0m11:02:15.717743 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e'
[0m11:02:15.718611 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m11:02:15.719567 [debug] [Thread-3 (]: On test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc: BEGIN
[0m11:02:15.720333 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m11:02:15.721073 [debug] [Thread-1 (]: On test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e: Close
[0m11:02:15.721784 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m11:02:15.722370 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:02:15.724303 [debug] [Thread-2 (]: On test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40: ROLLBACK
[0m11:02:15.725186 [info ] [Thread-1 (]: 25 of 29 PASS unique_customer_rows_fct_customer_transactions_ .................. [[32mPASS[0m in 0.09s]
[0m11:02:15.725811 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:02:15.726724 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40'
[0m11:02:15.727306 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m11:02:15.728113 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e
[0m11:02:15.728892 [debug] [Thread-2 (]: On test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40: Close
[0m11:02:15.729555 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"
[0m11:02:15.730323 [debug] [Thread-1 (]: Began running node test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518
[0m11:02:15.731016 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:02:15.731950 [info ] [Thread-2 (]: 26 of 29 PASS unique_fct_customer_transactions_customer_id ..................... [[32mPASS[0m in 0.07s]
[0m11:02:15.732582 [debug] [Thread-3 (]: On test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select transaction_id
from "medallion"."main"."stg_transactions"
group by transaction_id
having count(*) > 1


  
  
      
    ) dbt_internal_test
[0m11:02:15.733220 [info ] [Thread-1 (]: 29 of 29 START test valid_timestamp_stg_transactions_transaction_ts ............ [RUN]
[0m11:02:15.735093 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m11:02:15.735890 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40
[0m11:02:15.737020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.unique_customer_rows_fct_customer_transactions_.3cc004383e, now test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518)
[0m11:02:15.738026 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m11:02:15.738690 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m11:02:15.739437 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518
[0m11:02:15.740085 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m11:02:15.807704 [debug] [Thread-3 (]: On test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc: ROLLBACK
[0m11:02:15.810199 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"
[0m11:02:15.811493 [info ] [Thread-4 (]: 27 of 29 PASS unique_stg_transactions_transaction_id ........................... [[32mPASS[0m in 0.13s]
[0m11:02:15.812349 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc'
[0m11:02:15.813584 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m11:02:15.814390 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518
[0m11:02:15.815138 [debug] [Thread-3 (]: On test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc: Close
[0m11:02:15.819141 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"
[0m11:02:15.820577 [info ] [Thread-3 (]: 28 of 29 PASS unique_transaction_id_stg_transactions_transaction_id ............ [[32mPASS[0m in 0.14s]
[0m11:02:15.821939 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc
[0m11:02:15.822980 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"
[0m11:02:15.823660 [debug] [Thread-1 (]: On test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518: BEGIN
[0m11:02:15.824291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:15.825384 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:02:15.826011 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"
[0m11:02:15.826633 [debug] [Thread-1 (]: On test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null


  
  
      
    ) dbt_internal_test
[0m11:02:15.828443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:02:15.830362 [debug] [Thread-1 (]: On test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518: ROLLBACK
[0m11:02:15.831022 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518'
[0m11:02:15.831587 [debug] [Thread-1 (]: On test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518: Close
[0m11:02:15.832441 [info ] [Thread-1 (]: 29 of 29 PASS valid_timestamp_stg_transactions_transaction_ts .................. [[32mPASS[0m in 0.10s]
[0m11:02:15.833257 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518
[0m11:02:15.834789 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:15.835324 [debug] [MainThread]: On master: BEGIN
[0m11:02:15.835826 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:15.837168 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:02:15.837823 [debug] [MainThread]: On master: COMMIT
[0m11:02:15.838397 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:15.838912 [debug] [MainThread]: On master: COMMIT
[0m11:02:15.839692 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:02:15.840292 [debug] [MainThread]: On master: Close
[0m11:02:15.840955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:15.841426 [debug] [MainThread]: Connection 'test.medallion_dbt.valid_timestamp_stg_transactions_transaction_ts.7d85f20518' was properly closed.
[0m11:02:15.841890 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_fct_customer_transactions_customer_id.9960d4ab40' was properly closed.
[0m11:02:15.842346 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_transaction_id_stg_transactions_transaction_id.c4748253bc' was properly closed.
[0m11:02:15.842809 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m11:02:15.843370 [info ] [MainThread]: 
[0m11:02:15.843900 [info ] [MainThread]: Finished running 29 data tests in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m11:02:15.849614 [debug] [MainThread]: Command end result
[0m11:02:15.883055 [debug] [MainThread]: Wrote artifact WritableManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/manifest.json
[0m11:02:15.885009 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/semantic_manifest.json
[0m11:02:15.895867 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/matias/Documentos/UdeSA/MIA/T3/ISD_examenes/segundo_examen_ISD_Mesch_Caccia/dbt/target/run_results.json
[0m11:02:15.896449 [info ] [MainThread]: 
[0m11:02:15.897028 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:02:15.897551 [info ] [MainThread]: 
[0m11:02:15.898075 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=29
[0m11:02:15.899131 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9801892, "process_in_blocks": "0", "process_kernel_time": 0.170942, "process_mem_max_rss": "160296", "process_out_blocks": "2944", "process_user_time": 3.434853}
[0m11:02:15.899849 [debug] [MainThread]: Command `dbt test` succeeded at 11:02:15.899726 after 1.98 seconds
[0m11:02:15.900394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ef4c2ac160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ef4d952a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ef4b3f4a00>]}
[0m11:02:15.900962 [debug] [MainThread]: Flushing usage events
[0m11:02:16.713639 [debug] [MainThread]: An error was encountered while trying to flush usage events
